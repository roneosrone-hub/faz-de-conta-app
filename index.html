<!doctype html>
<html lang="pt-br">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Faz de Conta Decora√ß√µes ‚Ä¢ Cat√°logo</title>

  <style>
    :root{
      --bg0:#070916;
      --bg1:#0b1230;
      --card: rgba(255,255,255,.08);
      --card2: rgba(255,255,255,.06);
      --stroke: rgba(255,255,255,.14);
      --text: rgba(255,255,255,.92);
      --muted: rgba(255,255,255,.65);
      --muted2: rgba(255,255,255,.45);
      --shadow: 0 18px 50px rgba(0,0,0,.55);
      --radius: 22px;
      --radius2: 18px;
    }

    *{ box-sizing:border-box; }
    html,body{ height:100%; }
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, "Noto Sans", "Liberation Sans";
      color:var(--text);
      background:
        radial-gradient(1200px 700px at 15% 15%, rgba(122, 66, 255,.25), transparent 60%),
        radial-gradient(900px 600px at 80% 30%, rgba(0, 255, 213,.14), transparent 55%),
        radial-gradient(900px 600px at 40% 90%, rgba(255, 64, 208,.12), transparent 50%),
        linear-gradient(180deg, var(--bg0), var(--bg1));
      overflow-x:hidden;
    }

    .spark{
      position:fixed; inset:0; pointer-events:none; opacity:.55;
      background:
        radial-gradient(2px 2px at 20% 30%, rgba(255,255,255,.25), transparent 60%),
        radial-gradient(2px 2px at 35% 55%, rgba(255,255,255,.18), transparent 60%),
        radial-gradient(1px 1px at 70% 20%, rgba(255,255,255,.20), transparent 60%),
        radial-gradient(2px 2px at 85% 70%, rgba(255,255,255,.16), transparent 60%);
      filter: blur(.2px);
      mix-blend-mode: screen;
    }

    .wrap{
      width:min(1120px, 92vw);
      margin: 18px auto 48px;
    }

    .floatingSlogan{
      position: sticky;
      top: 10px;
      z-index: 10;
      width: fit-content;
      margin-bottom: 10px;
      padding: 8px 12px;
      border-radius: 999px;
      background: rgba(0,0,0,.22);
      border:1px solid rgba(255,255,255,.12);
      box-shadow: 0 12px 30px rgba(0,0,0,.25);
      color: rgba(255,255,255,.92);
      font-weight: 900;
      letter-spacing:.2px;
      display:flex;
      align-items:center;
      gap:8px;
    }
    .floatingSlogan .star{ filter: drop-shadow(0 6px 14px rgba(0,0,0,.55)); }

    .header{
      display:flex;
      flex-direction:column;
      gap:14px;
      padding: 18px;
      border-radius: var(--radius);
      background: linear-gradient(180deg, rgba(255,255,255,.10), rgba(255,255,255,.06));
      border:1px solid var(--stroke);
      box-shadow: var(--shadow);
      backdrop-filter: blur(10px);
      overflow:hidden;
      position:relative;
    }

    .header::before{
      content:"";
      position:absolute; inset:-2px;
      background: radial-gradient(700px 200px at 20% 10%, rgba(255,255,255,.10), transparent 55%),
                  radial-gradient(600px 240px at 80% 0%, rgba(0,255,213,.12), transparent 55%);
      opacity:.65;
      pointer-events:none;
    }

    .headTop{
      display:flex;
      gap:18px;
      align-items:flex-start;
      justify-content:space-between;
      flex-wrap:wrap;
      position:relative;
      z-index:1;
    }

    .brandCenter{
      flex: 1;
      min-width: 320px;
      display:flex;
      align-items:center;
      justify-content:flex-start;
      gap:14px;
    }

    .logo{
      width:160px; height:140px;
      border-radius: 18px;
      background: rgba(0,0,0,.25);
      border:1px solid rgba(255,255,255,.12);
      overflow:hidden;
      box-shadow: 0 14px 35px rgba(0,0,0,.35);
      flex:0 0 auto;
      position:relative;
      display:flex;
      align-items:center;
      justify-content:center;
      font-weight: 1000;
      letter-spacing:.5px;
      color: rgba(255,255,255,.85);
    }
    .logo img{
      width:100%; height:100%;
      object-fit: cover;
      display:block;
    }

    .gradTitle{
      font-weight: 1000;
      font-size: 44px;
      line-height: 1.05;
      text-align:left;
      letter-spacing: .6px;
      text-transform: uppercase;

      background: linear-gradient(
        90deg,
        #ff4bd8 0%,
        #7a42ff 18%,
        #00c7ff 34%,
        #00ffd5 50%,
        #7dff6a 66%,
        #ffd94a 82%,
        #ff4bd8 100%
      );
      background-size: 260% 100%;
      -webkit-background-clip:text;
      background-clip:text;
      color: transparent;
      animation: gradMove 6.5s linear infinite;
      filter: drop-shadow(0 10px 30px rgba(0,0,0,.55));
    }
    @keyframes gradMove{
      0%{ background-position:0% 50%; }
      100%{ background-position:260% 50%; }
    }

    .sloganBelow{
      margin-top: 6px;
      text-align:left;
      font-size: 17px;
      font-weight: 900;
      color: rgba(255,255,255,.92);
      letter-spacing:.2px;
      text-shadow: 0 10px 26px rgba(0,0,0,.45);
    }

    .panelTop{
      width: 340px;
      max-width: 100%;
      border-radius: 18px;
      background: rgba(0,0,0,.20);
      border:1px solid rgba(255,255,255,.12);
      box-shadow: 0 14px 35px rgba(0,0,0,.25);
      padding: 14px;
    }
    .panelTop h2{
      margin:0 0 8px;
      font-size: 18px;
      letter-spacing:.2px;
    }
    .panelTop p{
      margin:0 0 12px;
      color: rgba(255,255,255,.70);
      font-size: 13px;
      line-height:1.35;
    }

    .field{
      display:flex;
      align-items:center;
      gap:10px;
      padding: 10px 12px;
      border-radius: 14px;
      background: rgba(0,0,0,.22);
      border:1px solid rgba(255,255,255,.12);
      margin-bottom: 10px;
    }
    .field input, .field select{
      width:100%;
      border:none;
      outline:none;
      background: transparent;
      color: rgba(255,255,255,.9);
      font-size: 13px;
    }
    .field input::placeholder{ color: rgba(255,255,255,.35); }

    .row{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
      justify-content:space-between;
      margin-top: 10px;
    }

    .toggle{
      display:flex;
      align-items:center;
      gap:10px;
      color: rgba(255,255,255,.75);
      font-size: 13px;
      background: rgba(0,0,0,.20);
      border:1px solid rgba(255,255,255,.12);
      border-radius: 14px;
      padding: 10px 12px;
      user-select:none;
    }
    .switch{
      width: 44px; height: 26px;
      border-radius: 999px;
      background: rgba(255,255,255,.14);
      border:1px solid rgba(255,255,255,.14);
      position:relative;
      cursor:pointer;
      flex:0 0 auto;
    }
    .knob{
      width: 22px; height: 22px;
      border-radius: 999px;
      background: rgba(255,255,255,.92);
      position:absolute;
      top:1px; left:1px;
      transition: left .18s ease, background .18s ease;
    }
    .switch.on{ background: rgba(0,255,213,.24); }
    .switch.on .knob{ left: 21px; background: rgba(255,255,255,.96); }

    .btn{
      display:inline-flex;
      align-items:center;
      justify-content:center;
      gap:10px;
      border:none;
      cursor:pointer;
      color: rgba(255,255,255,.92);
      background: rgba(255,255,255,.08);
      border:1px solid rgba(255,255,255,.14);
      padding: 10px 12px;
      border-radius: 14px;
      font-weight: 800;
      font-size: 13px;
      box-shadow: 0 14px 35px rgba(0,0,0,.28);
      transition: transform .15s ease, background .15s ease, border-color .15s ease;
      user-select:none;
    }
    .btn:hover{ transform: translateY(-1px); background: rgba(255,255,255,.11); border-color: rgba(255,255,255,.18); }
    .btn.primary{
      background: linear-gradient(90deg, rgba(255,75,216,.38), rgba(0,255,213,.26), rgba(255,217,74,.24));
      border-color: rgba(255,255,255,.18);
    }
    .pill{
      display:inline-flex;
      align-items:center;
      justify-content:center;
      min-width: 28px;
      height: 22px;
      padding: 0 8px;
      border-radius: 999px;
      background: rgba(0,0,0,.28);
      border:1px solid rgba(255,255,255,.14);
      font-weight: 1000;
      font-size: 12px;
      margin-left: 6px;
    }

    .actions{
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      align-items: center;
      justify-content: flex-start;
      margin-top: 8px;
      position:relative;
      z-index:1;
    }

    /* ====== QUADRO GRANDE DE MONTAGEM ====== */
    .builderWrap{
      margin-top: 14px;
      display:grid;
      grid-template-columns: 1fr 340px;
      gap: 14px;
      align-items: stretch;
    }
    @media(max-width: 980px){
      .builderWrap{ grid-template-columns: 1fr; }
    }

    .card{
      border-radius: var(--radius);
      background: linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.05));
      border:1px solid var(--stroke);
      box-shadow: var(--shadow);
      backdrop-filter: blur(10px);
      overflow:hidden;
      position:relative;
    }

    .builder{
      height: 520px;
      background: rgba(0,0,0,.22);
      border-bottom: 1px solid rgba(255,255,255,.10);
      position:relative;
      border-radius: var(--radius);
      overflow:hidden;
    }
    .builderBase{
      position:absolute;
      inset:0;
      width:100%;
      height:100%;
      object-fit: cover;
      opacity:.95;
      filter: saturate(1.05) contrast(1.05);
      pointer-events:none;
      user-select:none;
    }

    .piece{
      position:absolute;
      top: 40%;
      left: 40%;
      width: 180px;
      transform: translate(-50%,-50%);
      cursor: grab;
      user-select:none;
      touch-action:none;
      filter: drop-shadow(0 18px 28px rgba(0,0,0,.55));
      border-radius: 14px;
    }
    .piece:active{ cursor: grabbing; }
    .hidden{ display:none; }

    .builderSide{
      padding: 14px;
    }
    .bpTitle{
      font-size: 16px;
      font-weight: 1000;
      margin: 2px 0 10px;
    }

    .layerItem{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      padding:10px 12px;
      border-radius: 14px;
      background: rgba(0,0,0,.22);
      border:1px solid rgba(255,255,255,.10);
      margin-bottom: 8px;
      cursor:pointer;
    }
    .layerItem.active{
      border-color: rgba(0,255,213,.35);
      box-shadow: 0 10px 26px rgba(0,0,0,.25);
    }
    .layerItem b{ font-size: 13px; }
    .layerItem small{ color: rgba(255,255,255,.65); }

    .bpControls{
      margin-top: 12px;
      padding: 12px;
      border-radius: 16px;
      background: rgba(0,0,0,.20);
      border:1px solid rgba(255,255,255,.10);
    }
    .ctrlLabel{
      font-weight: 900;
      font-size: 12px;
      color: rgba(255,255,255,.75);
      margin-bottom: 8px;
    }
    input[type="range"]{ width:100%; }

    .miniBtns{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:10px;
      margin-top: 10px;
    }
    .miniBtn{
      width:100%;
      padding: 10px 12px;
      border-radius: 14px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.08);
      color: rgba(255,255,255,.92);
      font-weight: 900;
      cursor:pointer;
    }
    .miniBtn:hover{ background: rgba(255,255,255,.11); }

    .sectionTitle{
      margin: 18px 0 10px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 10px;
    }
    .sectionTitle h3{
      margin:0;
      font-size: 16px;
      letter-spacing:.2px;
    }
    .badge{
      font-size: 12px;
      color: rgba(255,255,255,.65);
      padding: 8px 10px;
      border-radius: 999px;
      background: rgba(0,0,0,.22);
      border:1px solid rgba(255,255,255,.12);
    }

    .grid{
      display:grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 12px;
    }
    @media(max-width: 980px){ .grid{ grid-template-columns: repeat(2, 1fr);} }
    @media(max-width: 560px){ .grid{ grid-template-columns: 1fr;} }

    .item{ padding: 12px; cursor:pointer; }
    .thumb{
      height: 150px;
      border-radius: 18px;
      overflow:hidden;
      background: rgba(0,0,0,.22);
      border:1px solid rgba(255,255,255,.10);
      box-shadow: 0 12px 30px rgba(0,0,0,.25);
    }
    .thumb img{
      width:100%; height:100%;
      object-fit: cover;
      display:block;
      transform: scale(1.02);
      transition: transform .25s ease;
    }
    .item:hover .thumb img{ transform: scale(1.06); }

    .itemName{ margin: 10px 0 6px; font-weight: 1000; letter-spacing:.2px; }
    .itemDesc{
      margin:0;
      color: rgba(255,255,255,.65);
      font-size: 12px;
      line-height:1.35;
      min-height: 32px;
    }
    .itemFooter{
      margin-top: 10px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 10px;
      flex-wrap:wrap;
    }
    .price{ font-weight: 1000; font-size: 13px; color: rgba(255,255,255,.88); }
    .tag{
      font-size: 12px;
      color: rgba(255,255,255,.65);
      padding: 6px 10px;
      border-radius: 999px;
      background: rgba(0,0,0,.22);
      border:1px solid rgba(255,255,255,.10);
    }

    .footer{
      margin-top: 18px;
      text-align:center;
      color: rgba(255,255,255,.45);
      font-size: 12px;
    }

    @media(max-width: 560px){
      .gradTitle{ font-size: 34px; }
      .sloganBelow{ font-size: 15px; }
      .logo{ width:120px; height:110px; }
      .builder{ height: 420px; }
      .piece{ width: 150px; }
    }
  </style>
</head>

<body>
  <div class="spark"></div>

  <div class="wrap">
    <div class="floatingSlogan">
      <span class="star">‚ú®</span>
      <span>Onde a imagina√ß√£o vira festa</span>
    </div>

    <div class="header">
      <div class="headTop">
        <div class="brandCenter">
          <div class="logo" title="Logo">
            <img src="logo.png" alt="Faz de Conta Decora√ß√µes">
          </div>

          <div>
            <div class="gradTitle">FAZ DE CONTA DECORA√á√ïES</div>
            <div class="sloganBelow">‚ú® Onde a imagina√ß√£o vira festa</div>

            <div class="actions">
              <button class="btn" id="btnWhats">üí¨ WhatsApp</button>
              <button class="btn" id="btnCart">üõí Carrinho <span class="pill" id="cartCount">0</span></button>
              <button class="btn" id="btnContract">üìù Contrato</button>
              <button class="btn primary" id="btnFinish">‚úÖ Finalizar (Pix)</button>
            </div>
          </div>
        </div>

        <!-- MONTE SEU PEDIDO (AGORA NO TOPO DIREITO) -->
        <div class="panelTop">
          <h2>Monte seu pedido</h2>
          <p>Pesquise e clique nos itens para eles aparecerem na montagem.</p>

          <div class="field">
            üîé <input id="q" placeholder="Pesquisar (ex: cilindro, arco, cortina...)"/>
          </div>

          <div class="field">
            üß©
            <select id="cat">
              <option value="Todas">Todas as categorias</option>
            </select>
          </div>

          <div class="row">
            <div class="toggle">
              üîí Mostrar pre√ßos
              <div class="switch" id="priceSwitch"><div class="knob"></div></div>
            </div>
            <button class="btn" id="btnClear">üßº Limpar</button>
          </div>
        </div>
      </div>
    </div>

    <!-- QUADRO GRANDE: MONTAGEM + CONTROLES -->
    <div class="builderWrap">
      <div class="card">
        <div class="builder" id="builder">
          <img class="builderBase" src="preview/base.jpg" alt="Base">

          <img class="piece hidden" data-piece="cilindros" src="preview/cilindros.png" alt="Cilindros">
          <img class="piece hidden" data-piece="arco" src="preview/arco.png" alt="Arco">
          <img class="piece hidden" data-piece="cortina" src="preview/cortina.png" alt="Cortina">
          <img class="piece hidden" data-piece="tapete" src="preview/tapete.png" alt="Tapete">
          <img class="piece hidden" data-piece="item" src="preview/item.png" alt="Item">
        </div>
      </div>

      <div class="card builderSide">
        <div class="bpTitle">üé® Montagem do cliente</div>
        <div id="layerList"></div>

        <div class="bpControls">
          <div class="ctrlLabel">Tamanho do item selecionado</div>
          <input type="range" id="scaleRange" min="40" max="160" value="100">
          <div style="margin-top:6px; color:rgba(255,255,255,.75); font-weight:900">
            Escala: <span id="scaleLabel">100%</span>
          </div>

          <div class="miniBtns">
            <button class="miniBtn" id="btnFront">‚¨ÜÔ∏è Frente</button>
            <button class="miniBtn" id="btnBack">‚¨áÔ∏è Fundo</button>
            <button class="miniBtn" id="btnHide">üëÅÔ∏è Ocultar</button>
            <button class="miniBtn" id="btnReset">‚Ü©Ô∏è Reset</button>
          </div>
        </div>
      </div>
    </div>

    <!-- ITENS -->
    <div class="sectionTitle">
      <h3>‚ú® Itens do cat√°logo (clique para jogar na montagem)</h3>
      <div class="badge"><span id="itemsCount">0</span> itens</div>
    </div>

    <div class="grid" id="grid"></div>

    <div class="footer">¬© Faz de Conta Decora√ß√µes ‚Ä¢ Cat√°logo</div>
  </div>

<script>
  // ========= CONFIG =========
  const CONFIG = {
    whatsappNumber: "5566996223481",
    whatsappDisplay: "(66) 99622-3481",
  };

  const ITENS = [
    { id:"cilindros", nome:"Cilindros (Suporte)", cat:"Estruturas", desc:"Estruturas e suporte para decora√ß√£o.", preco:180,
      thumb:"cilindros-1.jpg" },
    { id:"arco", nome:"Arco de bal√µes", cat:"Bal√µes", desc:"Arco org√¢nico e tem√°tico (montagem sob consulta).", preco:450,
      thumb:"arco-1.jpg" },
    { id:"cortina", nome:"Cortina de LED", cat:"Ilumina√ß√£o", desc:"Fundo e acabamento com luz.", preco:120,
      thumb:"cortina-1.jpg" },
    { id:"tapete", nome:"Tapete para fotos", cat:"Cen√°rio", desc:"Base para fotos e cen√°rio.", preco:80,
      thumb:"tapete-1.jpg" },
    { id:"item", nome:"Item decorativo", cat:"Cen√°rio", desc:"Pe√ßa decorativa (troque a foto pelo seu item).", preco:60,
      thumb:"item-1.jpg" }
  ];

  const el = (id)=>document.getElementById(id);
  const money = (v)=> "R$ " + Number(v||0).toFixed(2).replace(".",",");

  // ======= ESTADO =======
  let showPrices = false;
  const state = {
    q: "",
    cat: "Todas",
    cart: new Map(),
  };

  // ======= SWITCH PRE√áOS =======
  function setSwitch(on){
    const sw = el("priceSwitch");
    sw.classList.toggle("on", on);
    showPrices = on;
    render();
  }
  el("priceSwitch").addEventListener("click", ()=> setSwitch(!showPrices));

  el("q").addEventListener("input",(e)=>{
    state.q = (e.target.value||"").toLowerCase().trim();
    render();
  });

  el("cat").addEventListener("change",(e)=>{
    state.cat = e.target.value;
    render();
  });

  el("btnClear").addEventListener("click", ()=>{
    state.q = "";
    state.cat = "Todas";
    el("q").value = "";
    el("cat").value = "Todas";
    render();
  });

  // ======= CATEGORIAS =======
  function buildCats(){
    const s = new Set(ITENS.map(i=>i.cat));
    const sel = el("cat");
    [...s].sort().forEach(c=>{
      const opt = document.createElement("option");
      opt.value = c; opt.textContent = c;
      sel.appendChild(opt);
    });
  }
  buildCats();

  // ======= RENDER GRID =======
  function passFilter(item){
    const okCat = (state.cat === "Todas") || (item.cat === state.cat);
    const t = (item.nome + " " + item.desc + " " + item.cat).toLowerCase();
    const okQ = !state.q || t.includes(state.q);
    return okCat && okQ;
  }

  function render(){
    const list = ITENS.filter(passFilter);
    el("itemsCount").textContent = list.length;

    const grid = el("grid");
    grid.innerHTML = "";

    list.forEach(item=>{
      const card = document.createElement("div");
      card.className = "card item";

      const thumb = document.createElement("div");
      thumb.className = "thumb";

      const img = document.createElement("img");
      img.src = item.thumb;
      img.onerror = ()=> img.src = "capa.jpg";

      thumb.appendChild(img);

      const name = document.createElement("div");
      name.className = "itemName";
      name.textContent = item.nome;

      const desc = document.createElement("p");
      desc.className = "itemDesc";
      desc.textContent = item.desc;

      const footer = document.createElement("div");
      footer.className = "itemFooter";

      const price = document.createElement("div");
      price.className = "price";
      price.textContent = showPrices ? money(item.preco) : "Pre√ßo: sob consulta";

      const tag = document.createElement("div");
      tag.className = "tag";
      tag.textContent = item.cat;

      footer.appendChild(tag);
      footer.appendChild(price);

      card.appendChild(thumb);
      card.appendChild(name);
      card.appendChild(desc);
      card.appendChild(footer);

      // CLIQUE NO ITEM => MOSTRA NA MONTAGEM E SELECIONA
      card.addEventListener("click", ()=> addToBuilder(item.id, item.nome));
      grid.appendChild(card);
    });

    el("cartCount").textContent = [...state.cart.values()].reduce((a,b)=>a+b,0);
  }
  render();

  // ======= WHATS / CARRINHO =======
  el("btnWhats").addEventListener("click", ()=>{
    const url = `https://wa.me/${CONFIG.whatsappNumber}?text=${encodeURIComponent("Ol√°! Quero informa√ß√µes sobre os itens do cat√°logo da Faz de Conta Decora√ß√µes.")}`;
    window.open(url, "_blank");
  });

  el("btnCart").addEventListener("click", ()=>{
    const totalItens = [...state.cart.values()].reduce((a,b)=>a+b,0);
    alert("Carrinho: " + totalItens + " item(ns).");
  });

  el("btnContract").addEventListener("click", ()=>{
    alert("Contrato: voc√™ pode colocar aqui depois (assinatura etc).");
  });

  el("btnFinish").addEventListener("click", ()=>{
    alert("Finalizar (Pix): pr√≥ximo passo √© gerar Pix Copia e Cola.");
  });

  // ========= MONTAGEM (DRAG + CAMADAS) =========
  const builder = el("builder");
  const layerList = el("layerList");
  const scaleRange = el("scaleRange");
  const scaleLabel = el("scaleLabel");
  const btnFront = el("btnFront");
  const btnBack = el("btnBack");
  const btnHide = el("btnHide");
  const btnReset = el("btnReset");

  let activePiece = null;
  let zTop = 10;

  function listPieces(){
    const pieces = [...builder.querySelectorAll(".piece")].filter(p=>!p.classList.contains("hidden"));
    return pieces.sort((a,b)=> (Number(a.style.zIndex||0) - Number(b.style.zIndex||0)));
  }

  function selectPiece(p){
    activePiece = p;
    // destaca no painel
    [...layerList.querySelectorAll(".layerItem")].forEach(x=>x.classList.remove("active"));
    const li = layerList.querySelector(`[data-li="${p.dataset.piece}"]`);
    if(li) li.classList.add("active");

    // atualiza escala
    const scale = p.dataset.scale ? Number(p.dataset.scale) : 100;
    scaleRange.value = scale;
    scaleLabel.textContent = scale + "%";
  }

  function rebuildLayerPanel(){
    const pieces = listPieces().reverse(); // topo primeiro
    layerList.innerHTML = "";

    if(pieces.length === 0){
      layerList.innerHTML = `<div style="color:rgba(255,255,255,.65);font-size:13px">
        Selecione itens no cat√°logo e eles aparecer√£o aqui.
      </div>`;
      return;
    }

    pieces.forEach(p=>{
      const nameMap = {
        cilindros:"Cilindros",
        arco:"Arco",
        cortina:"Cortina",
        tapete:"Tapete",
        item:"Item decorativo"
      };
      const div = document.createElement("div");
      div.className = "layerItem";
      div.dataset.li = p.dataset.piece;
      div.innerHTML = `<div><b>${nameMap[p.dataset.piece] || p.dataset.piece}</b><br><small>clique para selecionar</small></div>
                       <div style="opacity:.75;font-weight:900">#</div>`;
      div.addEventListener("click", ()=> selectPiece(p));
      layerList.appendChild(div);
    });

    // se n√£o tiver selecionado, seleciona o topo
    if(!activePiece) selectPiece(pieces[0]);
  }

  function addToBuilder(id, nome){
    const p = builder.querySelector(`.piece[data-piece="${id}"]`);
    if(!p) return;

    p.classList.remove("hidden");
    p.style.left = "50%";
    p.style.top = "50%";
    p.style.zIndex = String(++zTop);
    p.dataset.scale = "100";
    p.style.width = "180px";

    // marca no carrinho
    const n = state.cart.get(id) || 0;
    state.cart.set(id, n+1);

    selectPiece(p);
    rebuildLayerPanel();
    render();
  }

  // ======= DRAG =======
  let drag = null;

  function pointerDown(e){
    const target = e.target.closest(".piece");
    if(!target || target.classList.contains("hidden")) return;

    selectPiece(target);
    target.style.zIndex = String(++zTop);

    const rect = builder.getBoundingClientRect();
    const trect = target.getBoundingClientRect();

    const px = (e.touches ? e.touches[0].clientX : e.clientX);
    const py = (e.touches ? e.touches[0].clientY : e.clientY);

    drag = {
      target,
      startX: px,
      startY: py,
      offX: px - trect.left,
      offY: py - trect.top,
      rect
    };
    e.preventDefault();
  }

  function pointerMove(e){
    if(!drag) return;
    const px = (e.touches ? e.touches[0].clientX : e.clientX);
    const py = (e.touches ? e.touches[0].clientY : e.clientY);

    const x = px - drag.rect.left - drag.offX;
    const y = py - drag.rect.top - drag.offY;

    drag.target.style.left = x + "px";
    drag.target.style.top = y + "px";
    drag.target.style.transform = "translate(0,0)";
    e.preventDefault();
  }

  function pointerUp(){
    drag = null;
  }

  builder.addEventListener("mousedown", pointerDown);
  window.addEventListener("mousemove", pointerMove);
  window.addEventListener("mouseup", pointerUp);

  builder.addEventListener("touchstart", pointerDown, {passive:false});
  window.addEventListener("touchmove", pointerMove, {passive:false});
  window.addEventListener("touchend", pointerUp);

  // ======= CONTROLES =======
  scaleRange.addEventListener("input", ()=>{
    if(!activePiece) return;
    const v = Number(scaleRange.value);
    activePiece.dataset.scale = String(v);
    scaleLabel.textContent = v + "%";
    // ajusta largura proporcional
    const base = 180;
    activePiece.style.width = Math.round(base * (v/100)) + "px";
  });

  btnFront.addEventListener("click", ()=>{
    if(!activePiece) return;
    activePiece.style.zIndex = String(++zTop);
    rebuildLayerPanel();
  });

  btnBack.addEventListener("click", ()=>{
    if(!activePiece) return;
    activePiece.style.zIndex = "1";
    rebuildLayerPanel();
  });

  btnHide.addEventListener("click", ()=>{
    if(!activePiece) return;
    activePiece.classList.add("hidden");
    activePiece = null;
    rebuildLayerPanel();
  });

  btnReset.addEventListener("click", ()=>{
    // esconde tudo
    builder.querySelectorAll(".piece").forEach(p=>{
      p.classList.add("hidden");
      p.style.left = "40%";
      p.style.top = "40%";
      p.style.transform = "translate(-50%,-50%)";
      p.style.width = "180px";
      p.style.zIndex = "1";
      p.dataset.scale = "100";
    });
    activePiece = null;
    zTop = 10;
    state.cart.clear();
    rebuildLayerPanel();
    render();
  });

  rebuildLayerPanel();
</script>

</body>
</html>
