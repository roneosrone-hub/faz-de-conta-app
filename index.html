<!doctype html>
<html lang="pt-br">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Faz de Conta Decora√ß√µes ‚Ä¢ Cat√°logo + Montagem</title>

  <style>
    :root{
      --bg0:#070916;
      --bg1:#0b1230;
      --card: rgba(255,255,255,.08);
      --card2: rgba(255,255,255,.06);
      --stroke: rgba(255,255,255,.14);
      --text: rgba(255,255,255,.92);
      --muted: rgba(255,255,255,.65);
      --muted2: rgba(255,255,255,.45);
      --shadow: 0 18px 50px rgba(0,0,0,.55);
      --radius: 22px;
      --radius2: 18px;
      --accent: rgba(0,255,213,.28);
      --good: rgba(125,255,106,.25);
      --warn: rgba(255,217,74,.20);
      --danger: rgba(255,75,216,.20);
    }

    *{ box-sizing:border-box; }
    html,body{ height:100%; }
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, "Noto Sans", "Liberation Sans";
      color:var(--text);
      background:
        radial-gradient(1200px 700px at 15% 15%, rgba(122, 66, 255,.25), transparent 60%),
        radial-gradient(900px 600px at 80% 30%, rgba(0, 255, 213,.14), transparent 55%),
        radial-gradient(900px 600px at 40% 90%, rgba(255, 64, 208,.12), transparent 50%),
        linear-gradient(180deg, var(--bg0), var(--bg1));
      overflow-x:hidden;
    }

    .spark{
      position:fixed; inset:0; pointer-events:none; opacity:.55;
      background:
        radial-gradient(2px 2px at 20% 30%, rgba(255,255,255,.25), transparent 60%),
        radial-gradient(2px 2px at 35% 55%, rgba(255,255,255,.18), transparent 60%),
        radial-gradient(1px 1px at 70% 20%, rgba(255,255,255,.20), transparent 60%),
        radial-gradient(2px 2px at 85% 70%, rgba(255,255,255,.16), transparent 60%);
      filter: blur(.2px);
      mix-blend-mode: screen;
    }

    .wrap{ width:min(1180px, 92vw); margin: 18px auto 48px; }

    /* slogan flutuante */
    .floatingSlogan{
      position: sticky;
      top: 10px;
      z-index: 10;
      width: fit-content;
      margin-bottom: 10px;
      padding: 8px 12px;
      border-radius: 999px;
      background: rgba(0,0,0,.22);
      border:1px solid rgba(255,255,255,.12);
      box-shadow: 0 12px 30px rgba(0,0,0,.25);
      color: rgba(255,255,255,.92);
      font-weight: 900;
      letter-spacing:.2px;
      display:flex;
      align-items:center;
      gap:8px;
    }

    /* HEADER */
    .header{
      padding: 18px;
      border-radius: var(--radius);
      background: linear-gradient(180deg, rgba(255,255,255,.10), rgba(255,255,255,.06));
      border:1px solid var(--stroke);
      box-shadow: var(--shadow);
      backdrop-filter: blur(10px);
      overflow:hidden;
      position:relative;
    }
    .header::before{
      content:"";
      position:absolute; inset:-2px;
      background: radial-gradient(700px 200px at 20% 10%, rgba(255,255,255,.10), transparent 55%),
                  radial-gradient(600px 240px at 80% 0%, rgba(0,255,213,.12), transparent 55%);
      opacity:.65;
      pointer-events:none;
    }

    .headGrid{
      position:relative;
      z-index:1;
      display:grid;
      grid-template-columns: 1fr 370px;
      gap: 14px;
      align-items:stretch;
    }
    @media(max-width: 980px){
      .headGrid{ grid-template-columns: 1fr; }
    }

    .brandRow{
      display:flex;
      gap:14px;
      align-items:center;
      justify-content:flex-start;
      flex-wrap:wrap;
    }

    .logoBox{
      width:190px; height:170px;
      border-radius: 18px;
      background: rgba(0,0,0,.25);
      border:1px solid rgba(255,255,255,.12);
      overflow:hidden;
      box-shadow: 0 14px 35px rgba(0,0,0,.35);
      flex:0 0 auto;
      display:flex;
      align-items:center;
      justify-content:center;
      position:relative;
    }
    .logoBox img{
      width:100%; height:100%;
      object-fit: cover;
      display:block;
    }

    .brandText{ min-width: 240px; }
    .gradTitle{
      font-weight: 1000;
      font-size: 44px;
      line-height: 1.05;
      letter-spacing: .6px;
      text-transform: uppercase;
      background: linear-gradient(
        90deg,
        #ff4bd8 0%,
        #7a42ff 18%,
        #00c7ff 34%,
        #00ffd5 50%,
        #7dff6a 66%,
        #ffd94a 82%,
        #ff4bd8 100%
      );
      background-size: 260% 100%;
      -webkit-background-clip:text;
      background-clip:text;
      color: transparent;
      animation: gradMove 6.5s linear infinite;
      filter: drop-shadow(0 10px 30px rgba(0,0,0,.55));
    }
    @keyframes gradMove{
      0%{ background-position:0% 50%; }
      100%{ background-position:260% 50%; }
    }
    .sloganBelow{
      margin-top: 6px;
      font-size: 16px;
      font-weight: 950;
      color: rgba(255,255,255,.92);
      letter-spacing:.2px;
      text-shadow: 0 10px 26px rgba(0,0,0,.45);
    }

    .actions{
      margin-top: 14px;
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
    }
    .btn{
      display:inline-flex;
      align-items:center;
      justify-content:center;
      gap:10px;
      border:none;
      cursor:pointer;
      color: rgba(255,255,255,.92);
      background: rgba(255,255,255,.08);
      border:1px solid rgba(255,255,255,.14);
      padding: 10px 12px;
      border-radius: 14px;
      font-weight: 900;
      font-size: 13px;
      box-shadow: 0 14px 35px rgba(0,0,0,.28);
      transition: transform .15s ease, background .15s ease, border-color .15s ease;
      user-select:none;
    }
    .btn:hover{ transform: translateY(-1px); background: rgba(255,255,255,.11); border-color: rgba(255,255,255,.18); }
    .btn:active{ transform: translateY(0px) scale(.99); }
    .btn.primary{
      background: linear-gradient(90deg, rgba(255,75,216,.38), rgba(0,255,213,.26), rgba(255,217,74,.24));
      border-color: rgba(255,255,255,.18);
    }
    .pill{
      display:inline-flex;
      align-items:center;
      justify-content:center;
      min-width: 28px;
      height: 22px;
      padding: 0 8px;
      border-radius: 999px;
      background: rgba(0,0,0,.28);
      border:1px solid rgba(255,255,255,.14);
      font-weight: 1000;
      font-size: 12px;
      margin-left: 6px;
    }

    /* Painel "Monte seu pedido" */
    .panelCard{
      border-radius: var(--radius2);
      background: linear-gradient(180deg, rgba(0,0,0,.24), rgba(0,0,0,.16));
      border:1px solid rgba(255,255,255,.12);
      box-shadow: 0 18px 50px rgba(0,0,0,.28);
      padding: 14px;
      height:100%;
    }
    .panelCard h3{
      margin: 0 0 6px;
      font-size: 15px;
      letter-spacing:.2px;
      font-weight: 1000;
    }
    .panelCard p{
      margin:0 0 10px;
      color: rgba(255,255,255,.70);
      font-size: 12px;
      line-height:1.35;
    }
    .field{
      display:flex;
      align-items:center;
      gap:10px;
      padding: 10px 12px;
      border-radius: 14px;
      background: rgba(255,255,255,.06);
      border:1px solid rgba(255,255,255,.10);
      margin-bottom: 10px;
    }
    .field input, .field select{
      width:100%;
      border:none;
      outline:none;
      background: transparent;
      color: rgba(255,255,255,.92);
      font-size: 13px;
    }
    .field input::placeholder{ color: rgba(255,255,255,.35); }

    .row{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
      justify-content:space-between;
      margin-top: 8px;
    }
    .toggle{
      display:flex;
      align-items:center;
      gap:10px;
      color: rgba(255,255,255,.78);
      font-size: 12px;
      background: rgba(255,255,255,.06);
      border:1px solid rgba(255,255,255,.10);
      border-radius: 14px;
      padding: 10px 12px;
      user-select:none;
      flex:1;
    }
    .switch{
      width: 44px; height: 26px;
      border-radius: 999px;
      background: rgba(255,255,255,.14);
      border:1px solid rgba(255,255,255,.14);
      position:relative;
      cursor:pointer;
      flex:0 0 auto;
    }
    .knob{
      width: 22px; height: 22px;
      border-radius: 999px;
      background: rgba(255,255,255,.92);
      position:absolute;
      top:1px; left:1px;
      transition: left .18s ease;
    }
    .switch.on{ background: rgba(0,255,213,.24); }
    .switch.on .knob{ left: 21px; }

    /* Montagem (quadrao grande) */
    .montagemCard{
      margin-top: 14px;
      border-radius: var(--radius);
      background: linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.05));
      border:1px solid var(--stroke);
      box-shadow: var(--shadow);
      overflow:hidden;
      backdrop-filter: blur(10px);
    }

    .montagemHead{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      padding: 12px 14px;
      border-bottom:1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.18);
    }
    .montagemHead b{ font-size: 13px; }
    .hint{ color: rgba(255,255,255,.65); font-size: 12px; }

    .stageWrap{
      padding: 12px;
    }

    .stage{
      position:relative;
      width:100%;
      height: 440px;
      border-radius: 20px;
      border:1px solid rgba(255,255,255,.12);
      background:
        radial-gradient(900px 300px at 20% 20%, rgba(255,255,255,.06), transparent 55%),
        radial-gradient(700px 280px at 80% 30%, rgba(0,255,213,.08), transparent 55%),
        radial-gradient(700px 280px at 40% 90%, rgba(255,75,216,.06), transparent 55%),
        linear-gradient(180deg, rgba(0,0,0,.28), rgba(0,0,0,.18));
      overflow:hidden;
      box-shadow: 0 22px 70px rgba(0,0,0,.45);
    }
    @media(max-width: 700px){
      .stage{ height: 360px; }
    }

    /* Objetos dentro do stage */
    .obj{
      position:absolute;
      left: 50%;
      top: 50%;
      transform: translate(-50%,-50%) scale(1) rotate(0deg);
      transform-origin: center;
      cursor: grab;
      user-select:none;
      touch-action:none;
      border-radius: 12px;
      outline: 0;
    }
    .obj:active{ cursor: grabbing; }

    /* SUMIR PRETO (efeito profissional) */
    .obj.blendScreen{
      mix-blend-mode: screen;
    }

    .obj.selected{
      outline: 2px solid rgba(0,255,213,.35);
      box-shadow: 0 0 0 6px rgba(0,255,213,.10);
    }

    .obj img{
      display:block;
      max-width: 360px;
      max-height: 360px;
      width:auto; height:auto;
      pointer-events:none;
      filter: var(--objFilter, none);
    }

    /* Controles */
    .controls{
      padding: 12px 14px;
      border-top:1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.16);
      display:grid;
      grid-template-columns: 1.2fr .8fr;
      gap: 12px;
    }
    @media(max-width: 980px){
      .controls{ grid-template-columns: 1fr; }
    }

    .box{
      border-radius: 18px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.16);
      padding: 12px;
    }
    .boxTitle{
      font-weight: 1000;
      font-size: 12px;
      color: rgba(255,255,255,.78);
      margin-bottom: 10px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
    }
    .boxTitle span{ color: rgba(255,255,255,.55); font-weight: 800; }

    .sl{
      width:100%;
      accent-color: #00ffd5;
    }
    .gridBtns{
      display:grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 8px;
      margin-top: 10px;
    }
    @media(max-width: 700px){
      .gridBtns{ grid-template-columns: repeat(2, 1fr); }
    }
    .miniBtn{
      padding: 10px 10px;
      border-radius: 14px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.06);
      color: rgba(255,255,255,.92);
      font-weight: 900;
      font-size: 12px;
      cursor:pointer;
    }
    .miniBtn:hover{ background: rgba(255,255,255,.09); }
    .miniBtn.danger{ background: var(--danger); }
    .miniBtn.good{ background: var(--good); }
    .miniBtn.warn{ background: var(--warn); }

    .note{
      margin-top:10px;
      color: rgba(255,255,255,.65);
      font-size: 12px;
      line-height:1.35;
    }

    /* Cat√°logo */
    .sectionTitle{
      margin: 18px 0 10px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 10px;
    }
    .sectionTitle h3{
      margin:0;
      font-size: 16px;
      letter-spacing:.2px;
    }
    .badge{
      font-size: 12px;
      color: rgba(255,255,255,.65);
      padding: 8px 10px;
      border-radius: 999px;
      background: rgba(0,0,0,.22);
      border:1px solid rgba(255,255,255,.12);
    }

    .grid{
      display:grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 12px;
    }
    @media(max-width: 980px){ .grid{ grid-template-columns: repeat(2, 1fr);} }
    @media(max-width: 560px){ .grid{ grid-template-columns: 1fr;} }

    .card{
      border-radius: var(--radius);
      background: linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.05));
      border:1px solid var(--stroke);
      box-shadow: var(--shadow);
      backdrop-filter: blur(10px);
      overflow:hidden;
      position:relative;
    }
    .item{ padding: 12px; cursor:pointer; }
    .thumb{
      height: 150px;
      border-radius: 18px;
      overflow:hidden;
      background: rgba(0,0,0,.22);
      border:1px solid rgba(255,255,255,.10);
      box-shadow: 0 12px 30px rgba(0,0,0,.25);
      display:flex;
      align-items:center;
      justify-content:center;
    }
    .thumb img{
      width:100%; height:100%;
      object-fit: cover;
      display:block;
      transform: scale(1.02);
      transition: transform .25s ease;
    }
    .item:hover .thumb img{ transform: scale(1.06); }

    .itemName{ margin: 10px 0 6px; font-weight: 1000; letter-spacing:.2px; }
    .itemDesc{
      margin:0;
      color: rgba(255,255,255,.65);
      font-size: 12px;
      line-height:1.35;
      min-height: 32px;
    }
    .itemFooter{
      margin-top: 10px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 10px;
      flex-wrap:wrap;
    }
    .price{ font-weight: 1000; font-size: 13px; color: rgba(255,255,255,.88); }
    .tag{
      font-size: 12px;
      color: rgba(255,255,255,.65);
      padding: 6px 10px;
      border-radius: 999px;
      background: rgba(0,0,0,.22);
      border:1px solid rgba(255,255,255,.10);
    }

    .footer{
      margin-top: 18px;
      text-align:center;
      color: rgba(255,255,255,.45);
      font-size: 12px;
    }
  </style>
</head>

<body>
  <div class="spark"></div>

  <div class="wrap">
    <div class="floatingSlogan">
      <span>‚ú®</span>
      <span>Onde a imagina√ß√£o vira festa</span>
    </div>

    <!-- HEADER (marca + painel monte seu pedido) -->
    <div class="header">
      <div class="headGrid">

        <!-- LADO ESQUERDO: marca -->
        <div>
          <div class="brandRow">
            <div class="logoBox">
              <img src="assets/logo.png" alt="Logo Faz de Conta" onerror="this.style.display='none'">
            </div>

            <div class="brandText">
              <div class="gradTitle">FAZ DE CONTA DECORA√á√ïES</div>
              <div class="sloganBelow">‚ú® Onde a imagina√ß√£o vira festa</div>

              <div class="actions">
                <button class="btn" id="btnWhats">üí¨ WhatsApp</button>
                <button class="btn" id="btnCart">üõí Carrinho <span class="pill" id="cartCount">0</span></button>
                <button class="btn" id="btnResetStage">üßº Limpar montagem</button>
                <button class="btn primary" id="btnFinish">‚úÖ Finalizar (Pix)</button>
              </div>
            </div>
          </div>
        </div>

        <!-- LADO DIREITO: MONTE SEU PEDIDO (no lugar de Jaciara/Whats/Data) -->
        <div class="panelCard">
          <h3>Monte seu pedido</h3>
          <p>Pesquise e clique nos itens para eles aparecerem na montagem. Depois arraste e ajuste.</p>

          <div class="field">üîé
            <input id="q" placeholder="Pesquisar (ex: cilindro, arco, cortina...)"/>
          </div>

          <div class="field">üß©
            <select id="cat">
              <option value="Todas">Todas as categorias</option>
            </select>
          </div>

          <div class="row">
            <div class="toggle">
              üîí Mostrar pre√ßos
              <div class="switch" id="priceSwitch"><div class="knob"></div></div>
            </div>
            <button class="btn" id="btnClear">üßº Limpar filtros</button>
          </div>
        </div>

      </div>
    </div>

    <!-- QUADRO GRANDE DE MONTAGEM (no lugar do v√≠deo) -->
    <div class="montagemCard">
      <div class="montagemHead">
        <b>üß© Montagem do cliente</b>
        <div class="hint">Clique num item do cat√°logo ‚Üí ele entra aqui. Arraste com o dedo/mouse.</div>
      </div>

      <div class="stageWrap">
        <div class="stage" id="stage"></div>
      </div>

      <div class="controls">
        <div class="box">
          <div class="boxTitle">
            <div>Item selecionado: <span id="selName">Nenhum</span></div>
            <div id="selInfo">‚Äî</div>
          </div>

          <div style="display:grid; gap:10px;">
            <label style="font-size:12px; color:rgba(255,255,255,.78); font-weight:900;">
              Escala: <span id="scaleLabel">100%</span>
              <input class="sl" id="scale" type="range" min="30" max="220" value="100"/>
            </label>

            <label style="font-size:12px; color:rgba(255,255,255,.78); font-weight:900;">
              Rota√ß√£o: <span id="rotLabel">0¬∞</span>
              <input class="sl" id="rot" type="range" min="-180" max="180" value="0"/>
            </label>

            <label style="font-size:12px; color:rgba(255,255,255,.78); font-weight:900;">
              Opacidade: <span id="opLabel">100%</span>
              <input class="sl" id="op" type="range" min="20" max="100" value="100"/>
            </label>
          </div>

          <div class="gridBtns">
            <button class="miniBtn good" id="btnFront">‚¨ÜÔ∏è Frente</button>
            <button class="miniBtn good" id="btnBack">‚¨áÔ∏è Fundo</button>
            <button class="miniBtn warn" id="btnDup">üìå Duplicar</button>
            <button class="miniBtn danger" id="btnDel">üóëÔ∏è Apagar</button>
          </div>

          <div class="note">
            ‚úÖ Bal√µes / LED com fundo preto: o preto some automaticamente aqui (efeito profissional).<br/>
            Dica: se o item ficar ‚Äúforte demais‚Äù, diminua a opacidade.
          </div>
        </div>

        <div class="box">
          <div class="boxTitle">
            <div>üé® Cor do item (opcional)</div>
            <span>funciona melhor em bal√µes/LED</span>
          </div>

          <label style="font-size:12px; color:rgba(255,255,255,.78); font-weight:900;">
            Matiz (Hue): <span id="hueLabel">0</span>
            <input class="sl" id="hue" type="range" min="-180" max="180" value="0"/>
          </label>

          <label style="font-size:12px; color:rgba(255,255,255,.78); font-weight:900; margin-top:10px; display:block;">
            Satura√ß√£o: <span id="satLabel">100%</span>
            <input class="sl" id="sat" type="range" min="0" max="220" value="100"/>
          </label>

          <div class="gridBtns" style="grid-template-columns: repeat(2, 1fr); margin-top:12px;">
            <button class="miniBtn" id="btnResetStyle">‚ôªÔ∏è Reset cor</button>
            <button class="miniBtn" id="btnCenter">üéØ Centralizar</button>
          </div>

          <div class="note">
            Se no futuro voc√™ quiser ‚Äúcor por bal√£o‚Äù, d√° pra fazer usando camadas separadas (voc√™ j√° chegou a ter o zip com layers).
          </div>
        </div>
      </div>
    </div>

    <!-- CAT√ÅLOGO -->
    <div class="sectionTitle">
      <h3>‚ú® Itens do cat√°logo (clique para jogar na montagem)</h3>
      <div class="badge"><span id="itemsCount">0</span> itens</div>
    </div>

    <div class="grid" id="grid"></div>

    <div class="footer">¬© Faz de Conta Decora√ß√µes ‚Ä¢ Cat√°logo + Montagem</div>
  </div>

<script>
  // =========================
  // CONFIG
  // =========================
  const CONFIG = {
    whatsappNumber: "5566996223481",
    mensagemWhats: "Ol√°! Quero informa√ß√µes sobre os itens do cat√°logo da Faz de Conta Decora√ß√µes.",
  };

  // =========================
  // ITENS (troque src quando quiser)
  // DICA: itens com fundo preto (bal√µes/LED) use blend:'screen'
  // =========================
  const ITENS = [
    { id:"baloes", nome:"Bal√µes (Arco Org√¢nico)", cat:"Bal√µes", desc:"Bal√µes realistas para montagem. Arraste e ajuste.", preco:450,
      src:"assets/baloes.png", blend:"screen" },

    { id:"led", nome:"Cortina de LED", cat:"Ilumina√ß√£o", desc:"Cortina de LED para fundo e brilho.", preco:120,
      src:"assets/led.png", blend:"screen" },

    { id:"arco", nome:"Arco / Estrutura", cat:"Estruturas", desc:"Estrutura (aro/ret√¢ngulo) para composi√ß√£o.", preco:180,
      src:"assets/arco.png", blend:"normal" },

    { id:"tapete", nome:"Tapete para fotos", cat:"Cen√°rio", desc:"Base para fotos (ajuste escala e posi√ß√£o).", preco:80,
      src:"assets/tapete.png", blend:"normal" },

    { id:"cilindros", nome:"Cilindros (Suporte)", cat:"Estruturas", desc:"Cilindros/mesas para compor cen√°rio.", preco:180,
      src:"assets/cilindros.png", blend:"normal" },
  ];

  // =========================
  // UTIL
  // =========================
  const el = (id)=>document.getElementById(id);
  const money = (v)=> "R$ " + Number(v||0).toFixed(2).replace(".",",");

  // =========================
  // ESTADO FILTROS/CARRINHO
  // =========================
  let showPrices = false;
  const state = {
    q: "",
    cat: "Todas",
    cart: new Map(),
  };

  // =========================
  // FILTROS
  // =========================
  function setSwitch(on){
    const sw = el("priceSwitch");
    sw.classList.toggle("on", on);
    showPrices = on;
    renderCatalog();
  }
  el("priceSwitch").addEventListener("click", ()=> setSwitch(!showPrices));

  el("q").addEventListener("input",(e)=>{
    state.q = (e.target.value||"").toLowerCase().trim();
    renderCatalog();
  });
  el("cat").addEventListener("change",(e)=>{
    state.cat = e.target.value;
    renderCatalog();
  });
  el("btnClear").addEventListener("click", ()=>{
    state.q = "";
    state.cat = "Todas";
    el("q").value = "";
    el("cat").value = "Todas";
    renderCatalog();
  });

  // categorias
  function buildCats(){
    const s = new Set(ITENS.map(i=>i.cat));
    const sel = el("cat");
    [...s].sort().forEach(c=>{
      const opt = document.createElement("option");
      opt.value = c; opt.textContent = c;
      sel.appendChild(opt);
    });
  }
  buildCats();

  function passFilter(item){
    const okCat = (state.cat === "Todas") || (item.cat === state.cat);
    const t = (item.nome + " " + item.desc + " " + item.cat).toLowerCase();
    const okQ = !state.q || t.includes(state.q);
    return okCat && okQ;
  }

  // =========================
  // CAT√ÅLOGO
  // =========================
  function renderCatalog(){
    const list = ITENS.filter(passFilter);
    el("itemsCount").textContent = list.length;

    const grid = el("grid");
    grid.innerHTML = "";

    list.forEach(item=>{
      const card = document.createElement("div");
      card.className = "card item";

      const thumb = document.createElement("div");
      thumb.className = "thumb";

      const img = document.createElement("img");
      img.src = item.src;
      img.alt = item.nome;
      img.onerror = ()=> {
        img.src = "assets/capa.png";
      };
      thumb.appendChild(img);

      const name = document.createElement("div");
      name.className = "itemName";
      name.textContent = item.nome;

      const desc = document.createElement("p");
      desc.className = "itemDesc";
      desc.textContent = item.desc;

      const footer = document.createElement("div");
      footer.className = "itemFooter";

      const price = document.createElement("div");
      price.className = "price";
      price.textContent = showPrices ? money(item.preco) : "Pre√ßo: sob consulta";

      const tag = document.createElement("div");
      tag.className = "tag";
      tag.textContent = item.cat;

      footer.appendChild(tag);
      footer.appendChild(price);

      card.appendChild(thumb);
      card.appendChild(name);
      card.appendChild(desc);
      card.appendChild(footer);

      card.addEventListener("click", ()=>{
        addToStage(item);
        // carrinho +1
        const n = state.cart.get(item.id) || 0;
        state.cart.set(item.id, n+1);
        updateCartCount();
      });

      grid.appendChild(card);
    });
  }

  function updateCartCount(){
    el("cartCount").textContent = [...state.cart.values()].reduce((a,b)=>a+b,0);
  }

  renderCatalog();
  updateCartCount();

  // =========================
  // A√á√ïES HEADER
  // =========================
  el("btnWhats").addEventListener("click", ()=>{
    const url = `https://wa.me/${CONFIG.whatsappNumber}?text=${encodeURIComponent(CONFIG.mensagemWhats)}`;
    window.open(url, "_blank");
  });

  el("btnCart").addEventListener("click", ()=>{
    const totalItens = [...state.cart.values()].reduce((a,b)=>a+b,0);
    alert("Carrinho: " + totalItens + " item(ns).");
  });

  el("btnFinish").addEventListener("click", ()=>{
    const totalItens = [...state.cart.values()].reduce((a,b‰º¥)=>a+b,0);
    if(totalItens<=0){
      alert("Seu carrinho est√° vazio. Clique em um item do cat√°logo para adicionar.");
      return;
    }
    alert("Finalizar (Pix):\n(Pr√≥ximo passo: gerar Pix Copia e Cola.)");
  });

  // =========================
  // MONTAGEM (STAGE)
  // =========================
  const stage = el("stage");
  let selected = null;
  let zTop = 10;

  function clearSelection(){
    if(selected) selected.classList.remove("selected");
    selected = null;
    syncControls();
  }

  function selectObj(obj){
    if(selected) selected.classList.remove("selected");
    selected = obj;
    selected.classList.add("selected");
    syncControls();
  }

  function makeObj(item){
    const wrap = document.createElement("div");
    wrap.className = "obj" + (item.blend === "screen" ? " blendScreen" : "");
    wrap.dataset.name = item.nome;

    // estado do objeto
    wrap.dataset.x = "0";
    wrap.dataset.y = "0";
    wrap.dataset.scale = "1";
    wrap.dataset.rot = "0";
    wrap.dataset.op = "1";
    wrap.dataset.hue = "0";
    wrap.dataset.sat = "100";

    wrap.style.zIndex = String(++zTop);
    wrap.style.opacity = "1";

    const img = document.createElement("img");
    img.src = item.src;
    img.alt = item.nome;

    img.onerror = ()=> {
      img.src = "assets/capa.png";
    };

    wrap.appendChild(img);

    // clique seleciona
    wrap.addEventListener("pointerdown", (e)=>{
      e.stopPropagation();
      selectObj(wrap);
      startDrag(e, wrap);
    });

    return wrap;
  }

  function applyTransform(obj){
    const x = Number(obj.dataset.x || 0);
    const y = Number(obj.dataset.y || 0);
    const s = Number(obj.dataset.scale || 1);
    const r = Number(obj.dataset.rot || 0);
    const op = Number(obj.dataset.op || 1);
    obj.style.transform = `translate(calc(-50% + ${x}px), calc(-50% + ${y}px)) scale(${s}) rotate(${r}deg)`;
    obj.style.opacity = String(op);

    const hue = Number(obj.dataset.hue || 0);
    const sat = Number(obj.dataset.sat || 100);
    obj.querySelector("img").style.filter = `hue-rotate(${hue}deg) saturate(${sat}%)`;
  }

  function addToStage(item){
    const obj = makeObj(item);
    stage.appendChild(obj);

    // posi√ß√£o inicial levemente ‚Äúinteligente‚Äù
    const offset = Math.floor((Math.random()*60)-30);
    obj.dataset.x = String(offset);
    obj.dataset.y = String(offset);
    obj.dataset.scale = item.id === "tapete" ? "1.25" : "1";
    obj.dataset.rot = "0";
    applyTransform(obj);

    selectObj(obj);
  }

  // clique fora desmarca
  stage.addEventListener("pointerdown", ()=> clearSelection());

  // DRAG
  let dragging = false;
  let dragStart = null;

  function startDrag(e, obj){
    dragging = true;
    obj.setPointerCapture(e.pointerId);
    dragStart = {
      px: e.clientX,
      py: e.clientY,
      x: Number(obj.dataset.x || 0),
      y: Number(obj.dataset.y || 0),
      obj
    };
  }

  stage.addEventListener("pointermove", (e)=>{
    if(!dragging || !dragStart) return;
    const obj = dragStart.obj;
    const dx = e.clientX - dragStart.px;
    const dy = e.clientY - dragStart.py;
    obj.dataset.x = String(dragStart.x + dx);
    obj.dataset.y = String(dragStart.y + dy);
    applyTransform(obj);
    syncControls(false);
  });

  stage.addEventListener("pointerup", ()=>{
    dragging = false;
    dragStart = null;
  });

  // =========================
  // CONTROLES
  // =========================
  const scaleEl = el("scale");
  const rotEl = el("rot");
  const opEl = el("op");
  const hueEl = el("hue");
  const satEl = el("sat");

  function syncControls(updateSliders=true){
    if(!selected){
      el("selName").textContent = "Nenhum";
      el("selInfo").textContent = "‚Äî";
      if(updateSliders){
        scaleEl.value = 100;
        rotEl.value = 0;
        opEl.value = 100;
        hueEl.value = 0;
        satEl.value = 100;
        el("scaleLabel").textContent = "100%";
        el("rotLabel").textContent = "0¬∞";
        el("opLabel").textContent = "100%";
        el("hueLabel").textContent = "0";
        el("satLabel").textContent = "100%";
      }
      return;
    }

    el("selName").textContent = selected.dataset.name || "Item";
    el("selInfo").textContent = "Arraste no quadro";

    if(updateSliders){
      const s = Math.round((Number(selected.dataset.scale||1))*100);
      const r = Math.round(Number(selected.dataset.rot||0));
      const op = Math.round((Number(selected.dataset.op||1))*100);
      const hue = Math.round(Number(selected.dataset.hue||0));
      const sat = Math.round(Number(selected.dataset.sat||100));

      scaleEl.value = s;
      rotEl.value = r;
      opEl.value = op;
      hueEl.value = hue;
      satEl.value = sat;

      el("scaleLabel").textContent = s + "%";
      el("rotLabel").textContent = r + "¬∞";
      el("opLabel").textContent = op + "%";
      el("hueLabel").textContent = hue;
      el("satLabel").textContent = sat + "%";
    }
  }

  function withSelected(fn){
    if(!selected) return alert("Selecione um item na montagem.");
    fn(selected);
    applyTransform(selected);
    syncControls();
  }

  scaleEl.addEventListener("input", ()=>{
    if(!selected) return;
    const s = Number(scaleEl.value)/100;
    selected.dataset.scale = String(s);
    el("scaleLabel").textContent = scaleEl.value + "%";
    applyTransform(selected);
  });

  rotEl.addEventListener("input", ()=>{
    if(!selected) return;
    selected.dataset.rot = String(rotEl.value);
    el("rotLabel").textContent = rotEl.value + "¬∞";
    applyTransform(selected);
  });

  opEl.addEventListener("input", ()=>{
    if(!selected) return;
    selected.dataset.op = String(Number(opEl.value)/100);
    el("opLabel").textContent = opEl.value + "%";
    applyTransform(selected);
  });

  hueEl.addEventListener("input", ()=>{
    if(!selected) return;
    selected.dataset.hue = String(hueEl.value);
    el("hueLabel").textContent = hueEl.value;
    applyTransform(selected);
  });

  satEl.addEventListener("input", ()=>{
    if(!selected) return;
    selected.dataset.sat = String(satEl.value);
    el("satLabel").textContent = satEl.value + "%";
    applyTransform(selected);
  });

  el("btnFront").addEventListener("click", ()=> withSelected(obj=>{
    obj.style.zIndex = String(++zTop);
  }));

  el("btnBack").addEventListener("click", ()=> withSelected(obj=>{
    obj.style.zIndex = "1";
  }));

  el("btnDel").addEventListener("click", ()=> withSelected(obj=>{
    obj.remove();
    clearSelection();
  }));

  el("btnDup").addEventListener("click", ()=> withSelected(obj=>{
    const clone = obj.cloneNode(true);
    clone.classList.remove("selected");
    clone.style.zIndex = String(++zTop);

    // ajusta levemente posi√ß√£o
    clone.dataset.x = String(Number(obj.dataset.x||0) + 30);
    clone.dataset.y = String(Number(obj.dataset.y||0) + 20);

    // reatacha eventos
    clone.addEventListener("pointerdown", (e)=>{
      e.stopPropagation();
      selectObj(clone);
      startDrag(e, clone);
    });

    stage.appendChild(clone);
    applyTransform(clone);
    selectObj(clone);
  }));

  el("btnResetStyle").addEventListener("click", ()=> withSelected(obj=>{
    obj.dataset.hue = "0";
    obj.dataset.sat = "100";
  }));

  el("btnCenter").addEventListener("click", ()=> withSelected(obj=>{
    obj.dataset.x = "0";
    obj.dataset.y = "0";
  }));

  el("btnResetStage").addEventListener("click", ()=>{
    if(!confirm("Quer limpar toda a montagem?")) return;
    stage.innerHTML = "";
    clearSelection();
  });

  // inicia
  syncControls();
</script>

</body>
</html>
