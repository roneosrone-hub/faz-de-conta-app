<!doctype html>
<html lang="pt-br">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Faz de Conta Decora√ß√µes ‚Ä¢ Cat√°logo</title>

  <style>
    :root{
      --bg0:#070916;
      --bg1:#0b1230;
      --card: rgba(255,255,255,.08);
      --stroke: rgba(255,255,255,.14);
      --text: rgba(255,255,255,.92);
      --muted: rgba(255,255,255,.65);
      --shadow: 0 18px 50px rgba(0,0,0,.55);
      --radius: 22px;
      --radius2: 18px;
    }

    *{ box-sizing:border-box; }
    html,body{ height:100%; }
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, "Noto Sans", "Liberation Sans";
      color:var(--text);
      background:
        radial-gradient(1200px 700px at 15% 15%, rgba(122, 66, 255,.25), transparent 60%),
        radial-gradient(900px 600px at 80% 30%, rgba(0, 255, 213,.14), transparent 55%),
        radial-gradient(900px 600px at 40% 90%, rgba(255, 64, 208,.12), transparent 50%),
        linear-gradient(180deg, var(--bg0), var(--bg1));
      overflow-x:hidden;
    }

    .spark{
      position:fixed; inset:0; pointer-events:none; opacity:.55;
      background:
        radial-gradient(2px 2px at 20% 30%, rgba(255,255,255,.25), transparent 60%),
        radial-gradient(2px 2px at 35% 55%, rgba(255,255,255,.18), transparent 60%),
        radial-gradient(1px 1px at 70% 20%, rgba(255,255,255,.20), transparent 60%),
        radial-gradient(2px 2px at 85% 70%, rgba(255,255,255,.16), transparent 60%);
      filter: blur(.2px);
      mix-blend-mode: screen;
    }

    .wrap{
      width:min(1180px, 92vw);
      margin: 18px auto 48px;
    }

    /* SLOGAN FIXO (TOP) */
    .floatingSlogan{
      position: sticky;
      top: 10px;
      z-index: 10;
      width: fit-content;
      margin-bottom: 10px;
      padding: 10px 14px;
      border-radius: 999px;
      background: rgba(0,0,0,.22);
      border:1px solid rgba(255,255,255,.12);
      box-shadow: 0 12px 30px rgba(0,0,0,.25);
      color: rgba(255,255,255,.92);
      font-weight: 1000;
      letter-spacing:.2px;
      display:flex;
      align-items:center;
      gap:10px;
      font-size: 16px; /* aqui aumenta o ‚ÄúOnde a imagina√ß√£o vira festa‚Äù do topo */
    }
    .floatingSlogan .star{ filter: drop-shadow(0 6px 14px rgba(0,0,0,.55)); }

    /* HEADER */
    .header{
      display:flex;
      flex-direction:column;
      gap:14px;
      padding: 18px;
      border-radius: var(--radius);
      background: linear-gradient(180deg, rgba(255,255,255,.10), rgba(255,255,255,.06));
      border:1px solid var(--stroke);
      box-shadow: var(--shadow);
      backdrop-filter: blur(10px);
      overflow:hidden;
      position:relative;
    }

    .header::before{
      content:"";
      position:absolute; inset:-2px;
      background: radial-gradient(700px 200px at 20% 10%, rgba(255,255,255,.10), transparent 55%),
                  radial-gradient(600px 240px at 80% 0%, rgba(0,255,213,.12), transparent 55%);
      opacity:.65;
      pointer-events:none;
    }

    .headTop{
      display:grid;
      grid-template-columns: 1.2fr .8fr;
      gap:14px;
      align-items:stretch;
      position:relative;
      z-index:1;
    }
    @media(max-width: 980px){
      .headTop{ grid-template-columns: 1fr; }
    }

    /* Esquerda: marca */
    .brandLeft{
      display:flex;
      gap:14px;
      align-items:center;
      justify-content:flex-start;
      min-width: 280px;
    }

    .logo{
      width:190px; height:170px;
      border-radius: 18px;
      background: rgba(0,0,0,.25);
      border:1px solid rgba(255,255,255,.12);
      overflow:hidden;
      box-shadow: 0 14px 35px rgba(0,0,0,.35);
      flex:0 0 auto;
      position:relative;
      display:flex;
      align-items:center;
      justify-content:center;
      font-weight: 1000;
      letter-spacing:.5px;
      color: rgba(255,255,255,.85);
    }
    .logo img{
      width:100%; height:100%;
      object-fit: cover;
      display:none;
    }
    .logo.fallback{
      background: linear-gradient(135deg, rgba(255,75,216,.25), rgba(0,255,213,.18));
    }
    #logoFallbackText{ display:block; }

    .titleBlock{ min-width: 210px; }

    .gradTitle{
      font-weight: 1000;
      font-size: 44px;
      line-height: 1.05;
      text-align:left;
      letter-spacing: .6px;
      text-transform: uppercase;
      background: linear-gradient(
        90deg,
        #ff4bd8 0%,
        #7a42ff 18%,
        #00c7ff 34%,
        #00ffd5 50%,
        #7dff6a 66%,
        #ffd94a 82%,
        #ff4bd8 100%
      );
      background-size: 260% 100%;
      -webkit-background-clip:text;
      background-clip:text;
      color: transparent;
      animation: gradMove 6.5s linear infinite;
      filter: drop-shadow(0 10px 30px rgba(0,0,0,.55));
    }
    @keyframes gradMove{
      0%{ background-position:0% 50%; }
      100%{ background-position:260% 50%; }
    }

    .sloganBelow{
      margin-top: 6px;
      text-align:left;
      font-size: 16px; /* aqui aumenta o ‚ÄúOnde a imagina√ß√£o vira festa‚Äù do t√≠tulo */
      font-weight: 1000;
      color: rgba(255,255,255,.92);
      letter-spacing:.2px;
      text-shadow: 0 10px 26px rgba(0,0,0,.45);
      display:flex;
      align-items:center;
      gap:8px;
    }

    /* Direita: ‚ÄúMonte seu pedido‚Äù (foi para o lugar do Jaciara/Whats/Data) */
    .orderPanel{
      border-radius: 18px;
      background: rgba(0,0,0,.18);
      border:1px solid rgba(255,255,255,.10);
      padding: 14px;
      height:100%;
      box-shadow: 0 14px 35px rgba(0,0,0,.25);
    }
    .orderPanel h2{
      margin: 0 0 8px;
      font-size: 18px;
      letter-spacing:.2px;
    }
    .orderPanel p{
      margin: 0 0 12px;
      color: var(--muted);
      font-size: 13px;
      line-height:1.35;
    }

    .field{
      display:flex;
      align-items:center;
      gap:10px;
      padding: 10px 12px;
      border-radius: 14px;
      background: rgba(0,0,0,.22);
      border:1px solid rgba(255,255,255,.12);
      margin-bottom: 10px;
    }
    .field input, .field select{
      width:100%;
      border:none;
      outline:none;
      background: transparent;
      color: rgba(255,255,255,.9);
      font-size: 13px;
      font-weight: 800;
    }
    .field input::placeholder{ color: rgba(255,255,255,.35); }

    .row{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
      justify-content:space-between;
      margin-top: 10px;
    }

    .toggle{
      display:flex;
      align-items:center;
      gap:10px;
      color: rgba(255,255,255,.75);
      font-size: 13px;
      background: rgba(0,0,0,.20);
      border:1px solid rgba(255,255,255,.12);
      border-radius: 14px;
      padding: 10px 12px;
      user-select:none;
      font-weight: 800;
    }
    .switch{
      width: 44px; height: 26px;
      border-radius: 999px;
      background: rgba(255,255,255,.14);
      border:1px solid rgba(255,255,255,.14);
      position:relative;
      cursor:pointer;
      flex:0 0 auto;
    }
    .knob{
      width: 22px; height: 22px;
      border-radius: 999px;
      background: rgba(255,255,255,.92);
      position:absolute;
      top:1px; left:1px;
      transition: left .18s ease, background .18s ease;
    }
    .switch.on{ background: rgba(0,255,213,.24); }
    .switch.on .knob{ left: 21px; background: rgba(255,255,255,.96); }

    /* bot√µes */
    .actions{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
      justify-content:flex-start;
      position:relative;
      z-index:1;
    }

    .btn{
      display:inline-flex;
      align-items:center;
      justify-content:center;
      gap:10px;
      border:none;
      cursor:pointer;
      color: rgba(255,255,255,.92);
      background: rgba(255,255,255,.08);
      border:1px solid rgba(255,255,255,.14);
      padding: 10px 12px;
      border-radius: 14px;
      font-weight: 900;
      font-size: 13px;
      box-shadow: 0 14px 35px rgba(0,0,0,.28);
      transition: transform .15s ease, background .15s ease, border-color .15s ease;
      user-select:none;
    }
    .btn:hover{ transform: translateY(-1px); background: rgba(255,255,255,.11); border-color: rgba(255,255,255,.18); }
    .btn:active{ transform: translateY(0px) scale(.99); }
    .btn.primary{
      background: linear-gradient(90deg, rgba(255,75,216,.38), rgba(0,255,213,.26), rgba(255,217,74,.24));
      border-color: rgba(255,255,255,.18);
    }

    .pill{
      display:inline-flex;
      align-items:center;
      justify-content:center;
      min-width: 28px;
      height: 22px;
      padding: 0 8px;
      border-radius: 999px;
      background: rgba(0,0,0,.28);
      border:1px solid rgba(255,255,255,.14);
      font-weight: 1000;
      font-size: 12px;
      margin-left: 6px;
    }

    /* ====== PALCO (MONTAGEM COM MINIATURAS) ====== */
    .builderCard{
      border-radius: var(--radius);
      background: linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.05));
      border:1px solid var(--stroke);
      box-shadow: var(--shadow);
      backdrop-filter: blur(10px);
      overflow:hidden;
      position:relative;
      margin-top: 14px;
    }

    .builderWrap{
      padding: 14px;
    }

    .builderStage{
      height: 420px;
      border-radius: 22px;
      border:1px solid rgba(255,255,255,.14);
      background:
        radial-gradient(900px 400px at 50% 10%, rgba(255,255,255,.10), transparent 55%),
        linear-gradient(180deg, rgba(10,14,40,.55), rgba(6,8,22,.75));
      box-shadow: 0 18px 60px rgba(0,0,0,.45);
      position: relative;
      overflow: hidden;
    }
    .builderStage::after{
      content:"";
      position:absolute;
      left:0; right:0; bottom:-90px;
      height: 240px;
      background: radial-gradient(700px 240px at 50% 0%, rgba(255,255,255,.12), transparent 70%);
      transform: skewY(-6deg);
      opacity:.9;
      pointer-events:none;
    }

    .stageThemeLight{
      background:
        radial-gradient(900px 400px at 50% 10%, rgba(0,0,0,.06), transparent 55%),
        linear-gradient(180deg, rgba(245,245,255,.95), rgba(220,230,255,.92));
    }
    .stageThemeDark{
      background:
        radial-gradient(900px 400px at 50% 10%, rgba(255,255,255,.10), transparent 55%),
        linear-gradient(180deg, rgba(10,14,40,.55), rgba(6,8,22,.75));
    }
    .stageThemeParty{
      background:
        radial-gradient(900px 400px at 20% 10%, rgba(122,66,255,.25), transparent 60%),
        radial-gradient(700px 300px at 80% 25%, rgba(0,255,213,.14), transparent 55%),
        linear-gradient(180deg, rgba(8,10,25,.70), rgba(6,8,22,.90));
    }

    .piece{
      position:absolute;
      left: 50%;
      top: 45%;
      transform: translate(-50%,-50%);
      cursor: grab;
      user-select: none;
      touch-action: none;
      filter: drop-shadow(0 12px 30px rgba(0,0,0,.45));
    }
    .piece:active{ cursor: grabbing; }
    .piece .label{
      margin-top: 6px;
      text-align:center;
      font-size: 12px;
      font-weight: 1000;
      color: rgba(255,255,255,.86);
      text-shadow: 0 10px 26px rgba(0,0,0,.45);
    }
    .piece svg{
      display:block;
      width: 140px;
      height: 110px;
    }

    .builderControls{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      margin-top: 12px;
      align-items:center;
    }
    .ctrl{
      display:flex;
      align-items:center;
      gap:10px;
      padding: 10px 12px;
      border-radius: 14px;
      background: rgba(0,0,0,.20);
      border:1px solid rgba(255,255,255,.12);
      color: rgba(255,255,255,.80);
      font-size: 13px;
      font-weight: 900;
    }
    .ctrl select, .ctrl input{
      background: transparent;
      border:none;
      outline:none;
      color: rgba(255,255,255,.92);
      font-weight: 900;
    }
    .ctrl input[type="color"]{
      width: 42px;
      height: 30px;
      padding:0;
      border-radius: 10px;
      border:1px solid rgba(255,255,255,.18);
      cursor:pointer;
    }
    .ctrl input[type="range"]{ width: 180px; }

    .miniBar{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      margin-top: 12px;
    }

    /* SE√á√ÉO ITENS */
    .sectionTitle{
      margin: 18px 0 10px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 10px;
    }
    .sectionTitle h3{
      margin:0;
      font-size: 16px;
      letter-spacing:.2px;
    }
    .badge{
      font-size: 12px;
      color: rgba(255,255,255,.65);
      padding: 8px 10px;
      border-radius: 999px;
      background: rgba(0,0,0,.22);
      border:1px solid rgba(255,255,255,.12);
      font-weight: 900;
    }

    .grid{
      display:grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 12px;
    }
    @media(max-width: 980px){ .grid{ grid-template-columns: repeat(2, 1fr);} }
    @media(max-width: 560px){ .grid{ grid-template-columns: 1fr;} }

    .card{
      border-radius: var(--radius);
      background: linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.05));
      border:1px solid var(--stroke);
      box-shadow: var(--shadow);
      backdrop-filter: blur(10px);
      overflow:hidden;
      position:relative;
    }

    .item{ padding: 12px; cursor:pointer; }
    .thumb{
      height: 150px;
      border-radius: 18px;
      overflow:hidden;
      background: rgba(0,0,0,.22);
      border:1px solid rgba(255,255,255,.10);
      box-shadow: 0 12px 30px rgba(0,0,0,.25);
      position:relative;
    }
    .thumb img{
      width:100%; height:100%;
      object-fit: cover;
      display:block;
      transform: scale(1.02);
      transition: transform .25s ease;
    }
    .thumb .ph{
      position:absolute; inset:0;
      display:flex;
      align-items:center; justify-content:center;
      color: rgba(255,255,255,.70);
      font-weight: 900;
      letter-spacing:.2px;
      background:
        radial-gradient(300px 140px at 40% 30%, rgba(0,255,213,.14), transparent 60%),
        radial-gradient(260px 120px at 70% 70%, rgba(255,75,216,.12), transparent 60%),
        rgba(0,0,0,.22);
    }
    .item:hover .thumb img{ transform: scale(1.06); }

    .itemName{ margin: 10px 0 6px; font-weight: 1000; letter-spacing:.2px; }
    .itemDesc{
      margin:0;
      color: rgba(255,255,255,.65);
      font-size: 12px;
      line-height:1.35;
      min-height: 32px;
    }
    .itemFooter{
      margin-top: 10px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 10px;
      flex-wrap:wrap;
    }
    .price{ font-weight: 1000; font-size: 13px; color: rgba(255,255,255,.88); }
    .tag{
      font-size: 12px;
      color: rgba(255,255,255,.65);
      padding: 6px 10px;
      border-radius: 999px;
      background: rgba(0,0,0,.22);
      border:1px solid rgba(255,255,255,.10);
      font-weight: 900;
    }

    .footer{
      margin-top: 18px;
      text-align:center;
      color: rgba(255,255,255,.45);
      font-size: 12px;
    }

    /* MODAL CONTRATO */
    .modalBack{
      position:fixed; inset:0;
      background: rgba(0,0,0,.6);
      display:none;
      align-items:center;
      justify-content:center;
      padding: 16px;
      z-index: 999;
    }
    .modal{
      width: min(860px, 96vw);
      border-radius: 22px;
      background: linear-gradient(180deg, rgba(255,255,255,.10), rgba(255,255,255,.06));
      border:1px solid rgba(255,255,255,.16);
      box-shadow: 0 25px 90px rgba(0,0,0,.7);
      overflow:hidden;
      backdrop-filter: blur(12px);
    }
    .modalHead{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 10px;
      padding: 12px 14px;
      border-bottom:1px solid rgba(255,255,255,.10);
    }
    .modalHead strong{ font-size: 14px; }
    .x{
      border:none;
      width: 40px; height: 40px;
      border-radius: 14px;
      background: rgba(0,0,0,.25);
      border:1px solid rgba(255,255,255,.12);
      color: rgba(255,255,255,.88);
      font-weight: 1000;
      cursor:pointer;
    }
    .modalBody{
      padding: 12px;
    }

    .side{
      padding: 12px;
      border-radius: 18px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.18);
      height: 100%;
    }
    .side .line{
      color: rgba(255,255,255,.70);
      font-size: 13px;
      margin-bottom: 10px;
      line-height:1.35;
    }
    .side .line b{ color: rgba(255,255,255,.92); }

    canvas{
      width:100%;
      height: 140px;
      background: rgba(0,0,0,.22);
      border:1px solid rgba(255,255,255,.12);
      border-radius: 14px;
      display:block;
      touch-action: none;
    }
    .checkRow{
      display:flex;
      gap:10px;
      align-items:flex-start;
      margin-top: 10px;
      font-size: 12px;
      color: rgba(255,255,255,.70);
    }
    .checkRow input{ margin-top: 2px; }

    /* responsivo */
    @media(max-width: 560px){
      .gradTitle{ font-size: 34px; }
      .sloganBelow{ font-size: 15px; }
      .logo{ width:120px; height:110px; }
      .builderStage{ height: 360px; }
      .floatingSlogan{ font-size: 15px; }
    }
  </style>
</head>

<body>
  <div class="spark"></div>

  <div class="wrap">
    <div class="floatingSlogan">
      <span class="star">‚ú®</span>
      <span>Onde a imagina√ß√£o vira festa</span>
    </div>

    <!-- HEADER -->
    <div class="header" id="tiltHeader">
      <div class="headTop">
        <!-- ESQUERDA -->
        <div class="brandLeft">
          <div class="logo fallback" title="Logo" id="logoBox">
            <img id="logoImg" alt="Faz de Conta Decora√ß√µes"/>
            <span id="logoFallbackText">FC</span>
          </div>

          <div class="titleBlock">
            <div class="gradTitle">FAZ DE CONTA<br/>DECORA√á√ïES</div>
            <div class="sloganBelow">‚ú® Onde a imagina√ß√£o vira festa</div>

            <div class="actions" style="margin-top:12px">
              <button class="btn" id="btnWhats">üí¨ WhatsApp</button>
              <button class="btn" id="btnCart">üõí Carrinho <span class="pill" id="cartCount">0</span></button>
              <button class="btn" id="btnContract">üìù Contrato</button>
              <button class="btn primary" id="btnFinish">‚úÖ Finalizar (Pix)</button>
            </div>
          </div>
        </div>

        <!-- DIREITA (MONTE SEU PEDIDO) -->
        <div class="orderPanel">
          <h2>Monte seu pedido</h2>
          <p>Pesquise e clique nos itens para jogar na montagem. Voc√™ pode esconder/mostrar os pre√ßos.</p>

          <div class="field">
            üîé <input id="q" placeholder="Pesquisar (ex: cilindro, arco, cortina...)"/>
          </div>

          <div class="field">
            üß©
            <select id="cat">
              <option value="Todas">Todas as categorias</option>
            </select>
          </div>

          <div class="row">
            <div class="toggle">
              üîí Mostrar pre√ßos
              <div class="switch" id="priceSwitch"><div class="knob"></div></div>
            </div>
            <button class="btn" id="btnClear">üßº Limpar</button>
          </div>

          <div style="margin-top:12px; display:flex; gap:10px; flex-wrap:wrap;">
            <div class="tag">üìç <b id="cityChip">Jaciara/MT</b></div>
            <div class="tag">üí¨ <b>WhatsApp:</b> <span id="whatsChip">(66) 99622-3481</span></div>
            <div class="tag">üìÖ <span id="today">--/--/----</span> ‚Ä¢ ‚è∞ <b id="clock">--:--</b></div>
          </div>
        </div>
      </div>
    </div>

    <!-- PALCO / MONTAGEM -->
    <div class="builderCard">
      <div class="builderWrap">
        <div class="builderStage stageThemeDark" id="builderStage"></div>

        <div class="builderControls">
          <div class="ctrl">
            Fundo:
            <select id="bgTheme">
              <option value="dark">Escuro (Premium)</option>
              <option value="party">Festa (Colorido)</option>
              <option value="light">Claro (Clean)</option>
            </select>
          </div>

          <div class="ctrl">
            Cor:
            <input id="colorPicker" type="color" value="#00ffd5">
          </div>

          <div class="ctrl">
            Tamanho:
            <input id="scaleRange" type="range" min="60" max="170" value="100">
            <span id="scaleLabel">100%</span>
          </div>

          <button class="btn" id="btnDeletePiece">üóëÔ∏è Remover selecionado</button>
          <button class="btn" id="btnResetStage">üîÑ Limpar palco</button>
        </div>

        <div class="miniBar">
          <button class="btn" id="addArco">‚ûï Arco</button>
          <button class="btn" id="addBaloes">‚ûï Bal√µes</button>
          <button class="btn" id="addTapete">‚ûï Tapete</button>
          <button class="btn" id="addLed">‚ûï Cortina LED</button>
        </div>
      </div>
    </div>

    <!-- ITENS -->
    <div class="sectionTitle">
      <h3>‚ú® Itens do cat√°logo (clique para jogar na montagem)</h3>
      <div class="badge"><span id="itemsCount">0</span> itens</div>
    </div>

    <div class="grid" id="grid"></div>

    <div class="footer">¬© Faz de Conta Decora√ß√µes ‚Ä¢ Cat√°logo</div>
  </div>

  <!-- MODAL CONTRATO -->
  <div class="modalBack" id="modalContractBack">
    <div class="modal">
      <div class="modalHead">
        <strong>üìù Contrato r√°pido (assinatura)</strong>
        <button class="x" id="closeContract">‚úï</button>
      </div>

      <div class="modalBody">
        <div class="side">
          <div class="line">
            <b>Resumo do compromisso:</b><br/>
            Ao contratar, o cliente se compromete a <b>cuidar dos itens</b>, <b>n√£o molhar</b>, <b>n√£o riscar</b>, evitar exposi√ß√£o a calor,
            e <b>devolver no prazo combinado</b>. Danos e atrasos podem gerar cobran√ßa adicional (conforme combinado no WhatsApp).
          </div>

          <div class="checkRow">
            <input type="checkbox" id="agree"/>
            <label for="agree">Li e concordo com o compromisso acima.</label>
          </div>

          <div style="margin-top:12px; font-weight:1000; opacity:.95">Assinatura:</div>
          <canvas id="sign"></canvas>

          <div class="row" style="margin-top:12px">
            <button class="btn" id="clearSign">üßΩ Limpar assinatura</button>
            <button class="btn primary" id="saveSign">‚úÖ Salvar aceite</button>
          </div>

          <div class="side" id="signStatus" style="margin-top:12px">
            <div class="line"><b>Status:</b> Aguardando aceite.</div>
          </div>
        </div>
      </div>
    </div>
  </div>

<script>
  // ========= CONFIG =========
  const CONFIG = {
    whatsappNumber: "5566996223481",
    whatsappDisplay: "(66) 99622-3481",
    cidade: "Jaciara/MT"
  };

  // ========= ITENS (edite seus itens aqui) =========
  // Se voc√™ N√ÉO tiver as imagens no projeto, n√£o tem problema: vai aparecer um placeholder.
  const ITENS = [
    { id:"cilindros", nome:"Cilindros (Suporte)", cat:"Estruturas", desc:"Estruturas e suporte para decora√ß√£o.", preco:180, thumb:"cilindros-1.jpg", piece:"tapete" },
    { id:"arco", nome:"Arco de bal√µes", cat:"Bal√µes", desc:"Arco org√¢nico e tem√°tico (montagem sob consulta).", preco:450, thumb:"arco-1.jpg", piece:"arco" },
    { id:"cortina", nome:"Cortina de LED", cat:"Ilumina√ß√£o", desc:"Fundo e acabamento com luz.", preco:120, thumb:"cortina-1.jpg", piece:"led" },
    { id:"tapete", nome:"Tapete para fotos", cat:"Cen√°rio", desc:"Base para fotos e cen√°rio.", preco:80, thumb:"tapete-1.jpg", piece:"tapete" },
    { id:"baloes", nome:"Bal√µes (conjunto)", cat:"Bal√µes", desc:"Conjunto de bal√µes (cores configur√°veis).", preco:0, thumb:"baloes-1.jpg", piece:"baloes" }
  ];

  // ========= UTIL =========
  const el = (id)=>document.getElementById(id);
  const money = (v)=> "R$ " + Number(v||0).toFixed(2).replace(".",",");

  // ========= DATA / REL√ìGIO =========
  el("cityChip").textContent = CONFIG.cidade;
  el("whatsChip").textContent = CONFIG.whatsappDisplay;
  function tick(){
    const d = new Date();
    const dd = String(d.getDate()).padStart(2,"0");
    const mm = String(d.getMonth()+1).padStart(2,"0");
    const yy = d.getFullYear();
    el("today").textContent = `${dd}/${mm}/${yy}`;
    el("clock").textContent = d.toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"});
  }
  tick(); setInterval(tick, 1000);

  // ========= LOGO =========
  function loadLogo(){
    const img = el("logoImg");
    const box = el("logoBox");
    const fb = el("logoFallbackText");
    const candidates = ["logo.png","logo.jpg","logo.jpeg","logo.webp"];
    let i = 0;

    function tryNext(){
      if(i >= candidates.length){
        img.style.display = "none";
        fb.style.display = "block";
        box.classList.add("fallback");
        return;
      }
      img.src = candidates[i++];
    }

    img.onload = ()=>{
      img.style.display = "block";
      fb.style.display = "none";
      box.classList.remove("fallback");
    };
    img.onerror = tryNext;
    tryNext();
  }
  loadLogo();

  // ========= FILTROS / PRE√áOS =========
  let showPrices = false;
  const state = {
    q: "",
    cat: "Todas",
    cart: new Map(),
    contractOk: false
  };

  function setSwitch(on){
    const sw = el("priceSwitch");
    sw.classList.toggle("on", on);
    showPrices = on;
    render();
  }
  el("priceSwitch").addEventListener("click", ()=> setSwitch(!showPrices));

  el("q").addEventListener("input",(e)=>{
    state.q = (e.target.value||"").toLowerCase().trim();
    render();
  });
  el("cat").addEventListener("change",(e)=>{
    state.cat = e.target.value;
    render();
  });
  el("btnClear").addEventListener("click", ()=>{
    state.q = "";
    state.cat = "Todas";
    el("q").value = "";
    el("cat").value = "Todas";
    render();
  });

  function buildCats(){
    const s = new Set(ITENS.map(i=>i.cat));
    const sel = el("cat");
    [...s].sort().forEach(c=>{
      const opt = document.createElement("option");
      opt.value = c; opt.textContent = c;
      sel.appendChild(opt);
    });
  }
  buildCats();

  function passFilter(item){
    const okCat = (state.cat === "Todas") || (item.cat === state.cat);
    const t = (item.nome + " " + item.desc + " " + item.cat).toLowerCase();
    const okQ = !state.q || t.includes(state.q);
    return okCat && okQ;
  }

  // ========= BUILDER (MINIATURAS) =========
  const stage = el("builderStage");
  const bgTheme = el("bgTheme");
  const colorPicker = el("colorPicker");
  const scaleRange = el("scaleRange");
  const scaleLabel = el("scaleLabel");
  const btnDeletePiece = el("btnDeletePiece");
  const btnResetStage = el("btnResetStage");

  let selectedPiece = null;
  let zTop = 10;

  function setTheme(v){
    stage.classList.remove("stageThemeDark","stageThemeParty","stageThemeLight");
    if(v==="party") stage.classList.add("stageThemeParty");
    else if(v==="light") stage.classList.add("stageThemeLight");
    else stage.classList.add("stageThemeDark");
  }
  bgTheme.addEventListener("change", e=> setTheme(e.target.value));
  setTheme(bgTheme.value);

  function svgFor(kind, color){
    if(kind==="arco"){
      return `
      <svg viewBox="0 0 180 130" xmlns="http://www.w3.org/2000/svg">
        <path d="M20 105 C40 20, 140 20, 160 105" fill="none" stroke="${color}" stroke-width="14" stroke-linecap="round"/>
        <circle cx="48" cy="74" r="7" fill="${color}" opacity="0.9"/>
        <circle cx="70" cy="52" r="7" fill="${color}" opacity="0.85"/>
        <circle cx="92" cy="44" r="7" fill="${color}" opacity="0.8"/>
        <circle cx="114" cy="52" r="7" fill="${color}" opacity="0.85"/>
        <circle cx="136" cy="74" r="7" fill="${color}" opacity="0.9"/>
      </svg>`;
    }
    if(kind==="baloes"){
      return `
      <svg viewBox="0 0 180 130" xmlns="http://www.w3.org/2000/svg">
        <ellipse cx="65" cy="55" rx="26" ry="34" fill="${color}" opacity="0.9"/>
        <ellipse cx="102" cy="45" rx="24" ry="32" fill="${color}" opacity="0.75"/>
        <ellipse cx="120" cy="65" rx="22" ry="30" fill="${color}" opacity="0.6"/>
        <path d="M65 89 C60 100, 58 108, 55 118" stroke="${color}" stroke-width="4" fill="none" opacity="0.8"/>
        <path d="M102 77 C98 95, 92 106, 88 118" stroke="${color}" stroke-width="4" fill="none" opacity="0.7"/>
        <path d="M120 94 C118 104, 116 110, 112 118" stroke="${color}" stroke-width="4" fill="none" opacity="0.6"/>
      </svg>`;
    }
    if(kind==="tapete"){
      return `
      <svg viewBox="0 0 180 130" xmlns="http://www.w3.org/2000/svg">
        <rect x="18" y="40" width="144" height="70" rx="18" fill="${color}" opacity="0.75"/>
        <rect x="28" y="50" width="124" height="50" rx="14" fill="rgba(255,255,255,.12)"/>
      </svg>`;
    }
    return `
    <svg viewBox="0 0 180 130" xmlns="http://www.w3.org/2000/svg">
      <rect x="22" y="22" width="136" height="86" rx="16" fill="rgba(255,255,255,.08)" stroke="${color}" stroke-width="4" opacity="0.9"/>
      ${Array.from({length:7}).map((_,i)=>{
        const x = 40 + i*18;
        return `<circle cx="${x}" cy="44" r="4" fill="${color}" opacity="${0.45 + i*0.05}"/>
                <circle cx="${x}" cy="66" r="4" fill="${color}" opacity="${0.35 + i*0.05}"/>
                <circle cx="${x}" cy="88" r="4" fill="${color}" opacity="${0.25 + i*0.05}"/>`;
      }).join("")}
    </svg>`;
  }

  function nameFor(kind){
    if(kind==="arco") return "Arco";
    if(kind==="baloes") return "Bal√µes";
    if(kind==="tapete") return "Tapete";
    return "Cortina LED";
  }

  function createPiece(kind){
    const color = colorPicker.value || "#00ffd5";
    const piece = document.createElement("div");
    piece.className = "piece";
    piece.dataset.kind = kind;
    piece.dataset.color = color;
    piece.dataset.scale = "1";
    piece.style.left = "55%";
    piece.style.top = "55%";
    piece.style.zIndex = (++zTop).toString();

    piece.innerHTML = `
      <div class="shape">${svgFor(kind, color)}</div>
      <div class="label">${nameFor(kind)}</div>
    `;

    piece.addEventListener("pointerdown", (e)=>{
      selectPiece(piece);
      startDrag(e, piece);
    });

    stage.appendChild(piece);
    selectPiece(piece);
  }

  function selectPiece(piece){
    selectedPiece = piece;
    colorPicker.value = piece.dataset.color || "#00ffd5";
    const s = parseFloat(piece.dataset.scale || "1");
    const pct = Math.round(s * 100);
    scaleRange.value = String(pct);
    scaleLabel.textContent = `${pct}%`;
    piece.style.zIndex = (++zTop).toString();
  }

  function applyColor(piece, color){
    piece.dataset.color = color;
    piece.querySelector(".shape").innerHTML = svgFor(piece.dataset.kind, color);
  }

  function applyScale(piece, pct){
    const s = pct / 100;
    piece.dataset.scale = String(s);
    piece.style.transform = `translate(-50%,-50%) scale(${s})`;
  }

  colorPicker.addEventListener("input", ()=>{
    if(!selectedPiece) return;
    applyColor(selectedPiece, colorPicker.value);
  });

  scaleRange.addEventListener("input", ()=>{
    const pct = Number(scaleRange.value || 100);
    scaleLabel.textContent = `${pct}%`;
    if(!selectedPiece) return;
    applyScale(selectedPiece, pct);
  });

  btnDeletePiece.addEventListener("click", ()=>{
    if(!selectedPiece) return;
    selectedPiece.remove();
    selectedPiece = null;
  });

  btnResetStage.addEventListener("click", ()=>{
    stage.innerHTML = "";
    selectedPiece = null;
  });

  el("addArco").addEventListener("click", ()=> createPiece("arco"));
  el("addBaloes").addEventListener("click", ()=> createPiece("baloes"));
  el("addTapete").addEventListener("click", ()=> createPiece("tapete"));
  el("addLed").addEventListener("click", ()=> createPiece("led"));

  function startDrag(e, piece){
    piece.setPointerCapture(e.pointerId);

    const rect = stage.getBoundingClientRect();
    const startX = e.clientX;
    const startY = e.clientY;
    const pLeft = parseFloat(piece.style.left);
    const pTop  = parseFloat(piece.style.top);

    function move(ev){
      const dx = ev.clientX - startX;
      const dy = ev.clientY - startY;

      const leftPx = (pLeft/100)*rect.width + dx;
      const topPx  = (pTop/100)*rect.height + dy;

      const leftPct = (leftPx / rect.width) * 100;
      const topPct  = (topPx  / rect.height) * 100;

      piece.style.left = `${Math.max(5, Math.min(95, leftPct))}%`;
      piece.style.top  = `${Math.max(8, Math.min(92, topPct))}%`;
    }

    function up(ev){
      piece.releasePointerCapture(ev.pointerId);
      window.removeEventListener("pointermove", move);
      window.removeEventListener("pointerup", up);
    }

    window.addEventListener("pointermove", move);
    window.addEventListener("pointerup", up);
  }

  // ========= RENDER GRID =========
  function render(){
    const list = ITENS.filter(passFilter);
    el("itemsCount").textContent = list.length;

    const grid = el("grid");
    grid.innerHTML = "";

    list.forEach(item=>{
      const card = document.createElement("div");
      card.className = "card item";

      const thumb = document.createElement("div");
      thumb.className = "thumb";

      const img = document.createElement("img");
      img.src = item.thumb || "";
      img.alt = item.nome;

      const ph = document.createElement("div");
      ph.className = "ph";
      ph.textContent = "Imagem n√£o encontrada";

      img.onerror = ()=> {
        img.style.display = "none";
        ph.style.display = "flex";
      };
      img.onload = ()=>{
        ph.style.display = "none";
        img.style.display = "block";
      };

      thumb.appendChild(img);
      thumb.appendChild(ph);

      const name = document.createElement("div");
      name.className = "itemName";
      name.textContent = item.nome;

      const desc = document.createElement("p");
      desc.className = "itemDesc";
      desc.textContent = item.desc;

      const footer = document.createElement("div");
      footer.className = "itemFooter";

      const price = document.createElement("div");
      price.className = "price";
      price.textContent = showPrices ? money(item.preco) : "Pre√ßo: sob consulta";

      const tag = document.createElement("div");
      tag.className = "tag";
      tag.textContent = item.cat;

      footer.appendChild(tag);
      footer.appendChild(price);

      card.appendChild(thumb);
      card.appendChild(name);
      card.appendChild(desc);
      card.appendChild(footer);

      // clique joga na montagem
      card.addEventListener("click", ()=>{
        createPiece(item.piece || "tapete");
        // conta carrinho como ‚Äúselecionado‚Äù
        const n = state.cart.get(item.id) || 0;
        state.cart.set(item.id, n+1);
        el("cartCount").textContent = [...state.cart.values()].reduce((a,b)=>a+b,0);
      });

      grid.appendChild(card);
    });

    el("cartCount").textContent = [...state.cart.values()].reduce((a,b)=>a+b,0);
  }
  render();

  // ========= A√á√ïES =========
  el("btnWhats").addEventListener("click", ()=>{
    const url = `https://wa.me/${CONFIG.whatsappNumber}?text=${encodeURIComponent("Ol√°! Quero informa√ß√µes sobre os itens do cat√°logo da Faz de Conta Decora√ß√µes.")}`;
    window.open(url, "_blank");
  });

  el("btnCart").addEventListener("click", ()=>{
    const totalItens = [...state.cart.values()].reduce((a,b)=>a+b,0);
    alert("Carrinho: " + totalItens + " item(ns).");
  });

  // ========= CONTRATO + ASSINATURA =========
  function openContract(){ el("modalContractBack").style.display="flex"; }
  function closeContract(){ el("modalContractBack").style.display="none"; }
  el("btnContract").addEventListener("click", openContract);
  el("closeContract").addEventListener("click", closeContract);
  el("modalContractBack").addEventListener("click",(e)=>{
    if(e.target === el("modalContractBack")) closeContract();
  });

  const canvas = el("sign");
  const ctx = canvas.getContext("2d");
  let drawing = false;
  let hasStroke = false;

  function resizeCanvas(){
    const r = canvas.getBoundingClientRect();
    const dpr = window.devicePixelRatio || 1;
    canvas.width = Math.floor(r.width * dpr);
    canvas.height = Math.floor(r.height * dpr);
    ctx.setTransform(dpr, 0, 0, dpr, 0, 0);
    ctx.lineWidth = 2.4;
    ctx.lineCap = "round";
    ctx.strokeStyle = "rgba(255,255,255,.92)";
  }
  setTimeout(resizeCanvas, 60);
  window.addEventListener("resize", ()=> setTimeout(resizeCanvas, 60));

  function pos(e){
    const r = canvas.getBoundingClientRect();
    const x = (e.touches ? e.touches[0].clientX : e.clientX) - r.left;
    const y = (e.touches ? e.touches[0].clientY : e.clientY) - r.top;
    return {x,y};
  }

  function down(e){
    drawing = true;
    hasStroke = true;
    const p = pos(e);
    ctx.beginPath();
    ctx.moveTo(p.x, p.y);
    e.preventDefault();
  }
  function move(e){
    if(!drawing) return;
    const p = pos(e);
    ctx.lineTo(p.x, p.y);
    ctx.stroke();
    e.preventDefault();
  }
  function up(){ drawing = false; }

  canvas.addEventListener("mousedown", down);
  canvas.addEventListener("mousemove", move);
  window.addEventListener("mouseup", up);

  canvas.addEventListener("touchstart", down, {passive:false});
  canvas.addEventListener("touchmove", move, {passive:false});
  window.addEventListener("touchend", up);

  el("clearSign").addEventListener("click", ()=>{
    ctx.clearRect(0,0,canvas.width,canvas.height);
    hasStroke = false;
    state.contractOk = false;
    el("signStatus").innerHTML = '<div class="line"><b>Status:</b> Aguardando aceite.</div>';
  });

  el("saveSign").addEventListener("click", ()=>{
    const agreed = el("agree").checked;
    if(!agreed){
      el("signStatus").innerHTML = '<div class="line"><b>Status:</b> Marque "Li e concordo" para salvar.</div>';
      return;
    }
    if(!hasStroke){
      el("signStatus").innerHTML = '<div class="line"><b>Status:</b> Assine no quadro para salvar.</div>';
      return;
    }
    state.contractOk = true;
    el("signStatus").innerHTML = '<div class="line"><b>Status:</b> Aceite salvo ‚úÖ</div>';
    closeContract();
  });

  el("btnFinish").addEventListener("click", ()=>{
    if(!state.contractOk){
      alert("Antes de finalizar, abra o CONTRATO e salve o aceite com assinatura.");
      openContract();
      return;
    }
    const totalItens = [...state.cart.values()].reduce((a,b)=>a+b,0);
    if(totalItens<=0){
      alert("Seu carrinho est√° vazio. Clique em um item para adicionar.");
      return;
    }
    alert("Finalizar (Pix):\n(Pr√≥ximo passo: gerar Pix Copia e Cola.)");
  });
</script>

</body>
</html>
