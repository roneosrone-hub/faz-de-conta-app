<!doctype html>
<html lang="pt-br">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Faz de Conta Decora√ß√µes ‚Ä¢ Cat√°logo</title>

  <style>
    :root{
      --bg0:#070916;
      --bg1:#0b1230;
      --card: rgba(255,255,255,.08);
      --card2: rgba(255,255,255,.06);
      --stroke: rgba(255,255,255,.14);
      --text: rgba(255,255,255,.92);
      --muted: rgba(255,255,255,.65);
      --muted2: rgba(255,255,255,.45);
      --shadow: 0 18px 50px rgba(0,0,0,.55);
      --radius: 22px;
      --radius2: 18px;
    }

    *{ box-sizing:border-box; }
    html,body{ height:100%; }
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, "Noto Sans", "Liberation Sans";
      color:var(--text);
      background:
        radial-gradient(1200px 700px at 15% 15%, rgba(122, 66, 255,.25), transparent 60%),
        radial-gradient(900px 600px at 80% 30%, rgba(0, 255, 213,.14), transparent 55%),
        radial-gradient(900px 600px at 40% 90%, rgba(255, 64, 208,.12), transparent 50%),
        linear-gradient(180deg, var(--bg0), var(--bg1));
      overflow-x:hidden;
    }

    /* brilho discreto */
    .spark{
      position:fixed; inset:0; pointer-events:none; opacity:.55;
      background:
        radial-gradient(2px 2px at 20% 30%, rgba(255,255,255,.25), transparent 60%),
        radial-gradient(2px 2px at 35% 55%, rgba(255,255,255,.18), transparent 60%),
        radial-gradient(1px 1px at 70% 20%, rgba(255,255,255,.20), transparent 60%),
        radial-gradient(2px 2px at 85% 70%, rgba(255,255,255,.16), transparent 60%);
      filter: blur(.2px);
      mix-blend-mode: screen;
    }

    .wrap{
      width:min(1120px, 92vw);
      margin: 18px auto 48px;
    }

    /* SLOGAN FIXO (CANTO SUPERIOR ESQUERDO) */
    .floatingSlogan{
      position: sticky;
      top: 10px;
      z-index: 10;
      width: fit-content;
      margin-bottom: 10px;
      padding: 8px 12px;
      border-radius: 999px;
      background: rgba(0,0,0,.22);
      border:1px solid rgba(255,255,255,.12);
      box-shadow: 0 12px 30px rgba(0,0,0,.25);
      color: rgba(255,255,255,.92);
      font-weight: 900;
      letter-spacing:.2px;
      display:flex;
      align-items:center;
      gap:8px;
      backdrop-filter: blur(10px);
    }

    /* HEADER */
    .header{
      display:flex;
      flex-direction:column;
      gap:14px;
      padding: 18px;
      border-radius: var(--radius);
      background: linear-gradient(180deg, rgba(255,255,255,.10), rgba(255,255,255,.06));
      border:1px solid var(--stroke);
      box-shadow: var(--shadow);
      backdrop-filter: blur(10px);
      overflow:hidden;
      position:relative;
    }
    .header::before{
      content:"";
      position:absolute; inset:-2px;
      background:
        radial-gradient(700px 200px at 20% 10%, rgba(255,255,255,.10), transparent 55%),
        radial-gradient(600px 240px at 80% 0%, rgba(0,255,213,.12), transparent 55%);
      opacity:.65;
      pointer-events:none;
    }

    .headTop{
      display:flex;
      gap:14px;
      align-items:center;
      justify-content:space-between;
      flex-wrap:wrap;
      position:relative;
      z-index:1;
    }

    .brandCenter{
      flex: 1;
      min-width: 280px;
      display:flex;
      align-items:center;
      justify-content:center;
      gap:14px;
    }

    .logo{
      width:190px; height:170px;
      border-radius: 18px;
      background: rgba(0,0,0,.25);
      border:1px solid rgba(255,255,255,.12);
      overflow:hidden;
      box-shadow: 0 14px 35px rgba(0,0,0,.35);
      flex:0 0 auto;
      position:relative;
      display:flex;
      align-items:center;
      justify-content:center;
    }
    .logo img{
      width:100%;
      height:100%;
      object-fit: cover;
      display:block;
    }
    .logoFallback{
      display:none;
      font-weight: 1000;
      letter-spacing:.6px;
      color: rgba(255,255,255,.88);
      text-shadow: 0 12px 24px rgba(0,0,0,.55);
      background: linear-gradient(135deg, rgba(255,75,216,.25), rgba(0,255,213,.18));
      width:100%;
      height:100%;
      display:flex;
      align-items:center;
      justify-content:center;
    }
    .logo.fallback .logoFallback{ display:flex; }
    .logo.fallback img{ display:none; }

    .gradTitle{
      font-weight: 1000;
      font-size: 44px;
      line-height: 1.05;
      text-align:center;
      letter-spacing: .6px;
      text-transform: uppercase;
      background: linear-gradient(
        90deg,
        #ff4bd8 0%,
        #7a42ff 18%,
        #00c7ff 34%,
        #00ffd5 50%,
        #7dff6a 66%,
        #ffd94a 82%,
        #ff4bd8 100%
      );
      background-size: 260% 100%;
      -webkit-background-clip:text;
      background-clip:text;
      color: transparent;
      animation: gradMove 6.5s linear infinite;
      filter: drop-shadow(0 10px 30px rgba(0,0,0,.55));
    }
    @keyframes gradMove{
      0%{ background-position:0% 50%; }
      100%{ background-position:260% 50%; }
    }

    .sloganBelow{
      margin-top: 6px;
      text-align:center;
      font-size: 18px; /* AQUI voc√™ aumenta/diminui */
      font-weight: 900;
      color: rgba(255,255,255,.92);
      letter-spacing:.3px;
      text-shadow: 0 10px 26px rgba(0,0,0,.45);
    }

    /* meta (EMPILHADO) */
    .metaRow{
      display: flex;
      flex-direction: column;     /* um embaixo do outro */
      gap: 10px;
      align-items: flex-end;      /* colado √† direita */
      min-width: 260px;
      position:relative;
      z-index:1;
    }
    .chip{
      display:inline-flex;
      gap:8px;
      align-items:center;
      padding:8px 10px;
      border-radius: 999px;
      background: rgba(0,0,0,.22);
      border:1px solid rgba(255,255,255,.12);
      color: rgba(255,255,255,.78);
      font-size: 12px;
      white-space:nowrap;
      box-shadow: 0 10px 26px rgba(0,0,0,.25);
      backdrop-filter: blur(10px);
    }

    .actions{
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      align-items: center;
      justify-content: flex-start;
      margin-right: auto;
      position:relative;
      z-index:1;
    }

    .btn{
      display:inline-flex;
      align-items:center;
      justify-content:center;
      gap:10px;
      border:none;
      cursor:pointer;
      color: rgba(255,255,255,.92);
      background: rgba(255,255,255,.08);
      border:1px solid rgba(255,255,255,.14);
      padding: 10px 12px;
      border-radius: 14px;
      font-weight: 800;
      font-size: 13px;
      box-shadow: 0 14px 35px rgba(0,0,0,.28);
      transition: transform .15s ease, background .15s ease, border-color .15s ease;
      user-select:none;
    }
    .btn:hover{ transform: translateY(-1px); background: rgba(255,255,255,.11); border-color: rgba(255,255,255,.18); }
    .btn:active{ transform: translateY(0px) scale(.99); }
    .btn.primary{
      background: linear-gradient(90deg, rgba(255,75,216,.38), rgba(0,255,213,.26), rgba(255,217,74,.24));
      border-color: rgba(255,255,255,.18);
    }
    .pill{
      display:inline-flex;
      align-items:center;
      justify-content:center;
      min-width: 28px;
      height: 22px;
      padding: 0 8px;
      border-radius: 999px;
      background: rgba(0,0,0,.28);
      border:1px solid rgba(255,255,255,.14);
      font-weight: 1000;
      font-size: 12px;
      margin-left: 6px;
    }

    /* HERO */
    .hero{
      margin-top: 14px;
      display:grid;
      grid-template-columns: 1.25fr .95fr;
      gap: 14px;
      align-items:stretch;
    }
    @media(max-width: 980px){
      .hero{ grid-template-columns: 1fr; }
    }

    .card{
      border-radius: var(--radius);
      background: linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.05));
      border:1px solid var(--stroke);
      box-shadow: var(--shadow);
      backdrop-filter: blur(10px);
      overflow:hidden;
      position:relative;
    }

    /* QUADRO (montador) */
    .mediaBox{
      height: 240px; /* aqui controla a altura do quadro */
      display:flex;
      align-items:center;
      justify-content:center;
      background: rgba(0,0,0,.22);
      border-bottom: 1px solid rgba(255,255,255,.10);
      position:relative;
      padding: 10px;
    }
    @media(max-width:900px){
      .mediaBox{ height: 210px; }
    }

    .mediaInner{
      width:100%;
      height:100%;
      display:flex;
      align-items:stretch;
      justify-content:center;
      gap: 10px;
    }

    /* MONTADOR PROFISSIONAL */
    .builder{
      position: relative;
      flex: 1;
      border-radius: 18px;
      overflow: hidden;
      background:
        radial-gradient(900px 300px at 20% 10%, rgba(255,255,255,.10), transparent 60%),
        radial-gradient(700px 300px at 80% 0%, rgba(0,255,213,.10), transparent 55%),
        rgba(0,0,0,.25);
      border: 1px solid rgba(255,255,255,.12);
      box-shadow: 0 18px 60px rgba(0,0,0,.45);
      user-select: none;
      touch-action: none;
    }

    .builderBase{
      position:absolute;
      inset:0;
      width:100%;
      height:100%;
      object-fit: cover;
      filter: contrast(1.05) saturate(1.05);
      opacity: .98;
    }

    /* Grade sutil */
    .builderGrid{
      position:absolute;
      inset:0;
      background-image:
        linear-gradient(rgba(255,255,255,.06) 1px, transparent 1px),
        linear-gradient(90deg, rgba(255,255,255,.06) 1px, transparent 1px);
      background-size: 28px 28px;
      opacity:.15;
      pointer-events:none;
      mix-blend-mode: overlay;
    }

    .piece{
      position: absolute;
      left: 50%;
      top: 50%;
      width: 62%;
      max-width: 640px;
      transform: translate(-50%, -50%);
      cursor: grab;
      will-change: transform;
      transition: filter .15s ease, opacity .2s ease;
      filter: drop-shadow(0 14px 28px rgba(0,0,0,.52));
    }
    .piece:active{ cursor: grabbing; }
    .hidden{ opacity:0; pointer-events:none; }

    .piece.active{
      outline: 2px solid rgba(0,255,213,.45);
      outline-offset: 6px;
      filter: drop-shadow(0 18px 34px rgba(0,0,0,.62));
    }

    /* Painel lateral do montador */
    .builderPanel{
      width: 220px;
      border-radius: 18px;
      background: rgba(0,0,0,.22);
      border: 1px solid rgba(255,255,255,.12);
      box-shadow: 0 18px 60px rgba(0,0,0,.35);
      backdrop-filter: blur(10px);
      padding: 10px;
      display:flex;
      flex-direction:column;
      gap: 10px;
    }
    @media(max-width: 980px){
      .builderPanel{ width: 100%; }
      .mediaInner{ flex-direction: column; }
      .mediaBox{ height: auto; }
      .builder{ height: 240px; }
    }

    .bpTitle{
      font-weight: 1000;
      font-size: 12px;
      color: rgba(255,255,255,.92);
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      padding: 10px 12px;
      border-radius: 14px;
      background: rgba(255,255,255,.06);
      border: 1px solid rgba(255,255,255,.10);
    }
    .bpHint{
      font-size: 12px;
      color: rgba(255,255,255,.62);
      line-height: 1.35;
      padding: 10px 12px;
      border-radius: 14px;
      background: rgba(0,0,0,.18);
      border: 1px solid rgba(255,255,255,.10);
    }

    .layerList{
      display:flex;
      flex-direction:column;
      gap:8px;
    }
    .layerRow{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:8px;
      padding: 9px 10px;
      border-radius: 14px;
      background: rgba(0,0,0,.20);
      border: 1px solid rgba(255,255,255,.10);
      cursor:pointer;
    }
    .layerRow:hover{
      background: rgba(255,255,255,.06);
      border-color: rgba(255,255,255,.14);
    }
    .layerLeft{
      display:flex;
      align-items:center;
      gap:8px;
      min-width: 0;
    }
    .dot{
      width:10px; height:10px; border-radius:999px;
      background: rgba(255,255,255,.22);
      border: 1px solid rgba(255,255,255,.18);
      box-shadow: 0 10px 20px rgba(0,0,0,.35);
      flex:0 0 auto;
    }
    .layerName{
      font-size: 12px;
      font-weight: 900;
      color: rgba(255,255,255,.88);
      white-space:nowrap;
      overflow:hidden;
      text-overflow: ellipsis;
    }
    .layerRow.active{
      outline: 2px solid rgba(0,255,213,.32);
      outline-offset: 2px;
      background: rgba(0,255,213,.10);
    }
    .miniBtn{
      border:none;
      cursor:pointer;
      padding: 7px 9px;
      border-radius: 12px;
      background: rgba(255,255,255,.08);
      border: 1px solid rgba(255,255,255,.12);
      color: rgba(255,255,255,.9);
      font-weight: 1000;
      font-size: 12px;
      user-select:none;
    }
    .miniBtn:active{ transform: scale(.99); }
    .miniBtn[disabled]{ opacity:.55; cursor:not-allowed; }

    .bpControls{
      display:flex;
      flex-direction:column;
      gap:10px;
      padding: 10px 12px;
      border-radius: 14px;
      background: rgba(0,0,0,.18);
      border: 1px solid rgba(255,255,255,.10);
    }
    .ctrlRow{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
    }
    .ctrlLabel{
      font-size:12px;
      color: rgba(255,255,255,.75);
      font-weight: 900;
      white-space:nowrap;
    }
    input[type="range"]{
      width:100%;
      accent-color: #00ffd5;
    }

    .bpActions{
      display:flex;
      gap:10px;
    }
    .bpActions .miniBtn{
      flex:1;
      padding: 10px 10px;
      border-radius: 14px;
      font-size: 12px;
    }

    .mediaCaption{
      padding: 12px 14px;
      color: rgba(255,255,255,.72);
      font-size: 12px;
      display:flex;
      justify-content:space-between;
      gap: 10px;
      flex-wrap: wrap;
    }

    /* Painel */
    .panel{ padding: 14px; }
    .panel h2{
      margin: 2px 0 10px;
      font-size: 18px;
      letter-spacing:.2px;
    }
    .panel p{
      margin: 0 0 10px;
      color: var(--muted);
      font-size: 13px;
      line-height:1.35;
    }

    .field{
      display:flex;
      align-items:center;
      gap:10px;
      padding: 10px 12px;
      border-radius: 14px;
      background: rgba(0,0,0,.22);
      border:1px solid rgba(255,255,255,.12);
      margin-bottom: 10px;
    }
    .field input, .field select{
      width:100%;
      border:none;
      outline:none;
      background: transparent;
      color: rgba(255,255,255,.9);
      font-size: 13px;
    }
    .field input::placeholder{ color: rgba(255,255,255,.35); }

    .row{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
      justify-content:space-between;
      margin-top: 10px;
    }
    .toggle{
      display:flex;
      align-items:center;
      gap:10px;
      color: rgba(255,255,255,.75);
      font-size: 13px;
      background: rgba(0,0,0,.20);
      border:1px solid rgba(255,255,255,.12);
      border-radius: 14px;
      padding: 10px 12px;
      user-select:none;
    }
    .switch{
      width: 44px; height: 26px;
      border-radius: 999px;
      background: rgba(255,255,255,.14);
      border:1px solid rgba(255,255,255,.14);
      position:relative;
      cursor:pointer;
      flex:0 0 auto;
    }
    .knob{
      width: 22px; height: 22px;
      border-radius: 999px;
      background: rgba(255,255,255,.92);
      position:absolute;
      top:1px; left:1px;
      transition: left .18s ease, background .18s ease;
    }
    .switch.on{ background: rgba(0,255,213,.24); }
    .switch.on .knob{ left: 21px; background: rgba(255,255,255,.96); }

    /* Vers√≠culo */
    .verseBox{
      margin-top: 12px;
      padding: 14px 14px;
      border-radius: 16px;
      background: rgba(0,0,0,.22);
      border:1px solid rgba(255,255,255,.12);
      color: rgba(255,255,255,.86);
    }
    .verseTitle{
      font-weight: 1000;
      margin-bottom: 8px;
      display:flex;
      align-items:center;
      gap:8px;
    }
    .verseText{
      color: rgba(255,255,255,.78);
      line-height: 1.45;
      font-size: 13px;
      margin:0;
    }
    .verseRef{
      margin-top: 8px;
      font-weight: 900;
      color: rgba(255,255,255,.9);
      font-size: 12px;
      opacity:.92;
    }

    /* ITENS */
    .sectionTitle{
      margin: 18px 0 10px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 10px;
    }
    .sectionTitle h3{ margin:0; font-size: 16px; letter-spacing:.2px; }
    .badge{
      font-size: 12px;
      color: rgba(255,255,255,.65);
      padding: 8px 10px;
      border-radius: 999px;
      background: rgba(0,0,0,.22);
      border:1px solid rgba(255,255,255,.12);
    }

    .grid{
      display:grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 12px;
    }
    @media(max-width: 980px){ .grid{ grid-template-columns: repeat(2, 1fr);} }
    @media(max-width: 560px){ .grid{ grid-template-columns: 1fr;} }

    .item{ padding: 12px; cursor:pointer; }
    .thumb{
      height: 150px;
      border-radius: 18px;
      overflow:hidden;
      background: rgba(0,0,0,.22);
      border:1px solid rgba(255,255,255,.10);
      box-shadow: 0 12px 30px rgba(0,0,0,.25);
    }
    .thumb img{
      width:100%; height:100%;
      object-fit: cover;
      display:block;
      transform: scale(1.02);
      transition: transform .25s ease;
    }
    .item:hover .thumb img{ transform: scale(1.06); }

    .itemName{ margin: 10px 0 6px; font-weight: 1000; letter-spacing:.2px; }
    .itemDesc{
      margin:0;
      color: rgba(255,255,255,.65);
      font-size: 12px;
      line-height:1.35;
      min-height: 32px;
    }
    .itemFooter{
      margin-top: 10px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 10px;
      flex-wrap:wrap;
    }
    .price{ font-weight: 1000; font-size: 13px; color: rgba(255,255,255,.88); }
    .tag{
      font-size: 12px;
      color: rgba(255,255,255,.65);
      padding: 6px 10px;
      border-radius: 999px;
      background: rgba(0,0,0,.22);
      border:1px solid rgba(255,255,255,.10);
    }

    /* MODAL */
    .modalBack{
      position:fixed; inset:0;
      background: rgba(0,0,0,.6);
      display:none;
      align-items:center;
      justify-content:center;
      padding: 16px;
      z-index: 999;
    }
    .modal{
      width: min(960px, 96vw);
      border-radius: 22px;
      background: linear-gradient(180deg, rgba(255,255,255,.10), rgba(255,255,255,.06));
      border:1px solid rgba(255,255,255,.16);
      box-shadow: 0 25px 90px rgba(0,0,0,.7);
      overflow:hidden;
      backdrop-filter: blur(12px);
    }
    .modalHead{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 10px;
      padding: 12px 14px;
      border-bottom:1px solid rgba(255,255,255,.10);
    }
    .modalHead strong{ font-size: 14px; }
    .x{
      border:none;
      width: 40px; height: 40px;
      border-radius: 14px;
      background: rgba(0,0,0,.25);
      border:1px solid rgba(255,255,255,.12);
      color: rgba(255,255,255,.88);
      font-weight: 1000;
      cursor:pointer;
    }
    .modalBody{
      display:grid;
      grid-template-columns: 1.35fr .65fr;
      gap: 12px;
      padding: 12px;
    }
    @media(max-width: 900px){ .modalBody{ grid-template-columns: 1fr; } }

    .viewer{
      border-radius: 18px;
      overflow:hidden;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(0,0,0,.22);
      min-height: 280px;
      position:relative;
    }
    .viewer img, .viewer video{
      width:100%; height:100%;
      object-fit: cover;
      display:block;
    }
    .navBtn{
      position:absolute;
      top: 50%;
      transform: translateY(-50%);
      width: 44px; height: 44px;
      border-radius: 16px;
      background: rgba(0,0,0,.28);
      border:1px solid rgba(255,255,255,.14);
      color: rgba(255,255,255,.92);
      cursor:pointer;
      font-weight: 1000;
      display:flex;
      align-items:center;
      justify-content:center;
      user-select:none;
    }
    .navPrev{ left: 10px; }
    .navNext{ right: 10px; }

    .thumbs{
      display:grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 8px;
      margin-top: 10px;
    }
    .thumbs button{
      padding:0;
      border:none;
      background: transparent;
      cursor:pointer;
    }
    .mini{
      height: 64px;
      border-radius: 14px;
      overflow:hidden;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(0,0,0,.22);
      opacity: .85;
      transition: opacity .15s ease, transform .15s ease;
    }
    .mini img{ width:100%; height:100%; object-fit: cover; display:block; }
    .thumbs button.active .mini{
      opacity: 1;
      transform: translateY(-1px);
      border-color: rgba(0,255,213,.28);
    }

    .side{
      padding: 12px;
      border-radius: 18px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.18);
      height: 100%;
    }
    .side .line{
      color: rgba(255,255,255,.70);
      font-size: 13px;
      margin-bottom: 10px;
      line-height:1.35;
    }
    .side .line b{ color: rgba(255,255,255,.92); }

    /* Assinatura */
    canvas{
      width:100%;
      height: 140px;
      background: rgba(0,0,0,.22);
      border:1px solid rgba(255,255,255,.12);
      border-radius: 14px;
      display:block;
      touch-action: none;
    }
    .checkRow{
      display:flex;
      gap:10px;
      align-items:flex-start;
      margin-top: 10px;
      font-size: 12px;
      color: rgba(255,255,255,.70);
    }
    .checkRow input{ margin-top: 2px; }

    .footer{
      margin-top: 18px;
      text-align:center;
      color: rgba(255,255,255,.45);
      font-size: 12px;
    }

    /* responsivo */
    @media(max-width: 560px){
      .gradTitle{ font-size: 34px; }
      .sloganBelow{ font-size: 16px; }
      .logo{ width:150px; height:130px; }
    }
  </style>
</head>

<body>
  <div class="spark"></div>

  <div class="wrap">
    <div class="floatingSlogan">
      <span>‚ú®</span>
      <span>Onde a imagina√ß√£o vira festa</span>
    </div>

    <div class="header" id="tiltHeader">
      <div class="headTop">
        <div class="brandCenter">
          <div class="logo" title="Logo" id="logoBox">
            <img id="logoImg" alt="Faz de Conta Decora√ß√µes"/>
            <div class="logoFallback" id="logoFallbackText">FC</div>
          </div>

          <div style="min-width: 210px;">
            <div class="gradTitle">FAZ DE CONTA DECORA√á√ïES</div>
            <div class="sloganBelow">‚ú® Onde a imagina√ß√£o vira festa</div>
          </div>
        </div>

        <div class="metaRow">
          <div class="chip">üìç <b id="cityChip">Jaciara/MT</b></div>
          <div class="chip">üí¨ <b>WhatsApp:</b> <span id="whatsChip">(66) 99622-3481</span></div>
          <div class="chip">üìÖ <span id="today">--/--/----</span> ‚Ä¢ ‚è∞ <b id="clock">--:--</b></div>
        </div>
      </div>

      <div class="actions">
        <button class="btn" id="btnWhats">üí¨ WhatsApp</button>
        <button class="btn" id="btnCart">üõí Carrinho <span class="pill" id="cartCount">0</span></button>
        <button class="btn" id="btnContract">üìù Contrato</button>
        <button class="btn primary" id="btnFinish">‚úÖ Finalizar (Pix)</button>
      </div>
    </div>

    <div class="hero">
      <div class="card" id="tiltBanner">
        <div class="mediaBox">
          <div class="mediaInner">
            <div class="builder" id="builder">
              <img class="builderBase" id="builderBase" src="preview/base.jpg" alt="Base da montagem"/>
              <div class="builderGrid"></div>

              <img class="piece hidden" data-piece="cilindros" id="p-cilindros" src="preview/cilindros.png" alt="Cilindros"/>
              <img class="piece hidden" data-piece="arco"      id="p-arco"      src="preview/arco.png"      alt="Arco"/>
              <img class="piece hidden" data-piece="cortina"   id="p-cortina"   src="preview/cortina.png"   alt="Cortina LED"/>
              <img class="piece hidden" data-piece="tapete"    id="p-tapete"    src="preview/tapete.png"    alt="Tapete"/>
              <img class="piece hidden" data-piece="item"      id="p-item"      src="preview/item.png"      alt="Item decorativo"/>
            </div>

            <div class="builderPanel">
              <div class="bpTitle">
                <span>üß© Montagem do Cliente</span>
                <span style="opacity:.75;font-size:11px;">arraste/solte</span>
              </div>

              <div class="bpHint">
                Selecione itens no cat√°logo e eles aparecem aqui. Toque no item da lista para editar, arraste no quadro para posicionar.
              </div>

              <div class="layerList" id="layerList"></div>

              <div class="bpControls">
                <div class="ctrlRow">
                  <div class="ctrlLabel">Tamanho</div>
                  <div style="min-width:64px;text-align:right;font-size:12px;color:rgba(255,255,255,.75);" id="scaleLabel">100%</div>
                </div>
                <input id="scaleRange" type="range" min="40" max="140" value="100"/>

                <div class="ctrlRow">
                  <button class="miniBtn" id="btnBack" type="button">‚¨áÔ∏è Camada</button>
                  <button class="miniBtn" id="btnFront" type="button">‚¨ÜÔ∏è Camada</button>
                </div>

                <div class="bpActions">
                  <button class="miniBtn" id="btnResetBuild" type="button">‚Ü©Ô∏è Reset</button>
                  <button class="miniBtn" id="btnPrintHint" type="button">üì∏ Print</button>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="mediaCaption">
          <span>‚ú® Monte sua decora√ß√£o: arraste os itens no quadro</span>
          <span style="opacity:.85">Arquivos: <b>preview/base.jpg</b> + <b>preview/*.png</b></span>
        </div>
      </div>

      <div class="card panel">
        <h2>Monte seu pedido</h2>
        <p>Pesquise, filtre e clique nos itens para ver as fotos. Voc√™ pode esconder/mostrar os pre√ßos.</p>

        <div class="field">
          üîé <input id="q" placeholder="Pesquisar (ex: cilindro, arco, cortina...)"/>
        </div>

        <div class="field">
          üß©
          <select id="cat">
            <option value="Todas">Todas as categorias</option>
          </select>
        </div>

        <div class="row">
          <div class="toggle">
            üîí Mostrar pre√ßos
            <div class="switch" id="priceSwitch"><div class="knob"></div></div>
          </div>
          <button class="btn" id="btnClear">üßº Limpar</button>
        </div>

        <div class="verseBox" id="verseBox">
          <div class="verseTitle">üìñ Vers√≠culo b√≠blico do dia</div>
          <p class="verseText" id="verseText">Carregando‚Ä¶</p>
          <div class="verseRef" id="verseRef"></div>
        </div>
      </div>
    </div>

    <div class="sectionTitle">
      <h3>‚ú® Itens do cat√°logo</h3>
      <div class="badge"><span id="itemsCount">0</span> itens</div>
    </div>

    <div class="grid" id="grid"></div>

    <div class="footer">¬© Faz de Conta Decora√ß√µes ‚Ä¢ Cat√°logo</div>
  </div>

  <div class="modalBack" id="modalItemBack">
    <div class="modal">
      <div class="modalHead">
        <strong id="modalTitle">Item</strong>
        <button class="x" id="closeItem">‚úï</button>
      </div>

      <div class="modalBody">
        <div>
          <div class="viewer" id="viewer">
            <button class="navBtn navPrev" id="prevMedia">‚Äπ</button>
            <button class="navBtn navNext" id="nextMedia">‚Ä∫</button>
            <div id="viewerInner"></div>
          </div>
          <div class="thumbs" id="thumbs"></div>
        </div>

        <div class="side">
          <div class="line"><b>Descri√ß√£o:</b> <span id="modalDesc"></span></div>
          <div class="line"><b>Categoria:</b> <span id="modalCat"></span></div>
          <div class="line"><b>Pre√ßo:</b> <span id="modalPrice"></span></div>
          <div class="line" style="opacity:.8"><b>Fotos:</b> at√© 5 por item + v√≠deo opcional</div>

          <div class="row" style="margin-top:12px">
            <button class="btn" id="addCart">‚ûï Adicionar</button>
            <button class="btn" id="removeCart">‚ûñ Remover</button>
          </div>

          <div class="verseBox" style="margin-top:12px;">
            <div class="verseTitle">üìå Dica r√°pida</div>
            <p class="verseText" style="margin:0;">
              Para 5 fotos: use nomes tipo <b>arco-1.jpg</b> ‚Ä¶ <b>arco-5.jpg</b> (na raiz do projeto).
            </p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="modalBack" id="modalContractBack">
    <div class="modal">
      <div class="modalHead">
        <strong>üìù Contrato r√°pido (assinatura)</strong>
        <button class="x" id="closeContract">‚úï</button>
      </div>

      <div class="modalBody" style="grid-template-columns: 1fr;">
        <div class="side">
          <div class="line">
            <b>Resumo do compromisso:</b><br/>
            Ao contratar, o cliente se compromete a <b>cuidar dos itens</b>, <b>n√£o molhar</b>, <b>n√£o riscar</b>, evitar exposi√ß√£o a calor,
            e <b>devolver no prazo combinado</b>. Danos e atrasos podem gerar cobran√ßa adicional (conforme combinado no WhatsApp).
          </div>

          <div class="checkRow">
            <input type="checkbox" id="agree"/>
            <label for="agree">Li e concordo com o compromisso acima.</label>
          </div>

          <div style="margin-top:12px; font-weight:1000; opacity:.95">Assinatura:</div>
          <canvas id="sign"></canvas>

          <div class="row" style="margin-top:12px">
            <button class="btn" id="clearSign">üßΩ Limpar assinatura</button>
            <button class="btn primary" id="saveSign">‚úÖ Salvar aceite</button>
          </div>

          <div class="verseBox" id="signStatus" style="margin-top:12px">
            <div class="verseTitle">Status</div>
            <p class="verseText" style="margin:0;">Aguardando aceite.</p>
          </div>
        </div>
      </div>
    </div>
  </div>

<script>
  // ========= CONFIG =========
  const CONFIG = {
    whatsappNumber: "5566996223481",
    whatsappDisplay: "(66) 99622-3481",
    cidade: "Jaciara/MT"
  };

  // ========= ITENS =========
  const ITENS = [
    { id:"cilindros", nome:"Cilindros (Suporte)", cat:"Estruturas", desc:"Estruturas e suporte para decora√ß√£o.", preco:180,
      media:["cilindros-1.jpg","cilindros-2.jpg","cilindros-3.jpg","cilindros-4.jpg","cilindros-5.jpg"], video:"" },
    { id:"arco", nome:"Arco de bal√µes", cat:"Bal√µes", desc:"Arco org√¢nico e tem√°tico (montagem sob consulta).", preco:450,
      media:["arco-1.jpg","arco-2.jpg","arco-3.jpg","arco-4.jpg","arco-5.jpg"], video:"" },
    { id:"cortina", nome:"Cortina de LED", cat:"Ilumina√ß√£o", desc:"Fundo e acabamento com luz.", preco:120,
      media:["cortina-1.jpg","cortina-2.jpg","cortina-3.jpg","cortina-4.jpg","cortina-5.jpg"], video:"" },
    { id:"tapete", nome:"Tapete para fotos", cat:"Cen√°rio", desc:"Base para fotos e cen√°rio.", preco:80,
      media:["tapete-1.jpg","tapete-2.jpg","tapete-3.jpg","tapete-4.jpg","tapete-5.jpg"], video:"" },
    { id:"item", nome:"Item decorativo", cat:"Cen√°rio", desc:"Pe√ßa decorativa (troque a foto pelo seu item).", preco:60,
      media:["item-1.jpg","item-2.jpg","item-3.jpg","item-4.jpg","item-5.jpg"], video:"" }
  ];

  // ========= UTIL =========
  const el = (id)=>document.getElementById(id);
  const money = (v)=> "R$ " + Number(v||0).toFixed(2).replace(".",",");

  // ========= DATA / REL√ìGIO =========
  el("cityChip").textContent = CONFIG.cidade;
  el("whatsChip").textContent = CONFIG.whatsappDisplay;

  function tick(){
    const d = new Date();
    const dd = String(d.getDate()).padStart(2,"0");
    const mm = String(d.getMonth()+1).padStart(2,"0");
    const yy = d.getFullYear();
    el("today").textContent = `${dd}/${mm}/${yy}`;
    el("clock").textContent = d.toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"});
  }
  tick();
  setInterval(tick, 1000);

  // ========= LOGO (logo.png / logo.jpg / logo.jpeg / logo.webp) =========
  function loadLogo(){
    const img = el("logoImg");
    const box = el("logoBox");
    const candidates = ["logo.png","logo.jpg","logo.jpeg","logo.webp"];
    let i = 0;

    function tryNext(){
      if(i >= candidates.length){
        box.classList.add("fallback");
        return;
      }
      img.src = candidates[i++];
    }

    img.onload = ()=> box.classList.remove("fallback");
    img.onerror = tryNext;

    tryNext();
  }
  loadLogo();

  // ========= FILTROS / PRE√áOS =========
  let showPrices = false;
  const state = {
    q: "",
    cat: "Todas",
    cart: new Map(),
    contractOk: false
  };

  function setSwitch(on){
    const sw = el("priceSwitch");
    sw.classList.toggle("on", on);
    showPrices = on;
    render();
  }
  el("priceSwitch").addEventListener("click", ()=> setSwitch(!showPrices));

  el("q").addEventListener("input",(e)=>{
    state.q = (e.target.value||"").toLowerCase().trim();
    render();
  });
  el("cat").addEventListener("change",(e)=>{
    state.cat = e.target.value;
    render();
  });
  el("btnClear").addEventListener("click", ()=>{
    state.q = "";
    state.cat = "Todas";
    el("q").value = "";
    el("cat").value = "Todas";
    render();
  });

  function buildCats(){
    const s = new Set(ITENS.map(i=>i.cat));
    const sel = el("cat");
    [...s].sort().forEach(c=>{
      const opt = document.createElement("option");
      opt.value = c; opt.textContent = c;
      sel.appendChild(opt);
    });
  }
  buildCats();

  function passFilter(item){
    const okCat = (state.cat === "Todas") || (item.cat === state.cat);
    const t = (item.nome + " " + item.desc + " " + item.cat).toLowerCase();
    const okQ = !state.q || t.includes(state.q);
    return okCat && okQ;
  }

  function render(){
    const list = ITENS.filter(passFilter);
    el("itemsCount").textContent = list.length;

    const grid = el("grid");
    grid.innerHTML = "";

    list.forEach(item=>{
      const card = document.createElement("div");
      card.className = "card item";

      const thumb = document.createElement("div");
      thumb.className = "thumb";

      const img = document.createElement("img");
      const medias = (item.media||[]).filter(Boolean);
      let idx = 0;

      function setImg(){
        img.src = medias[idx] || "capa.jpg";
      }
      img.onerror = ()=>{
        idx++;
        if(idx < medias.length) setImg();
        else img.src = "capa.jpg";
      };
      setImg();

      thumb.appendChild(img);

      const name = document.createElement("div");
      name.className = "itemName";
      name.textContent = item.nome;

      const desc = document.createElement("p");
      desc.className = "itemDesc";
      desc.textContent = item.desc;

      const footer = document.createElement("div");
      footer.className = "itemFooter";

      const price = document.createElement("div");
      price.className = "price";
      price.textContent = showPrices ? money(item.preco) : "Pre√ßo: sob consulta";

      const tag = document.createElement("div");
      tag.className = "tag";
      tag.textContent = item.cat;

      footer.appendChild(tag);
      footer.appendChild(price);

      card.appendChild(thumb);
      card.appendChild(name);
      card.appendChild(desc);
      card.appendChild(footer);

      card.addEventListener("click", ()=> openItem(item.id));
      grid.appendChild(card);
    });

    el("cartCount").textContent = [...state.cart.values()].reduce((a,b)=>a+b,0);
    updateBuilderFromCart();
  }
  render();

  // ========= MODAL ITENS =========
  let currentItem = null;
  let mediaIndex = 0;
  let currentMediaList = [];

  function mediaListFor(item){
    const imgs = (item.media||[]).filter(Boolean);
    const out = imgs.map(src=>({type:"img",src}));
    if(item.video) out.push({type:"video", src:item.video});
    return out.length ? out : [{type:"img",src:"capa.jpg"}];
  }

  function renderViewer(){
    const viewer = el("viewerInner");
    viewer.innerHTML = "";
    const m = currentMediaList[mediaIndex];

    if(m.type === "video"){
      const v = document.createElement("video");
      v.src = m.src;
      v.controls = true;
      v.playsInline = true;
      v.style.background = "rgba(0,0,0,.22)";
      viewer.appendChild(v);
    }else{
      const img = document.createElement("img");
      img.src = m.src;
      img.onerror = ()=> img.src = "capa.jpg";
      viewer.appendChild(img);
    }

    const thumbs = el("thumbs");
    thumbs.innerHTML = "";
    currentMediaList.slice(0,4).forEach((mm, i)=>{
      const b = document.createElement("button");
      b.className = (i===mediaIndex ? "active" : "");
      b.addEventListener("click", ()=>{ mediaIndex=i; renderViewer(); });

      const mini = document.createElement("div");
      mini.className = "mini";

      const im = document.createElement("img");
      im.src = (mm.type==="img" ? mm.src : (currentItem.media[0] || "capa.jpg"));
      im.onerror = ()=> im.src = "capa.jpg";
      mini.appendChild(im);

      b.appendChild(mini);
      thumbs.appendChild(b);
    });
  }

  function openItem(id){
    currentItem = ITENS.find(x=>x.id===id);
    if(!currentItem) return;
    el("modalTitle").textContent = currentItem.nome;
    el("modalDesc").textContent = currentItem.desc;
    el("modalCat").textContent = currentItem.cat;
    el("modalPrice").textContent = showPrices ? money(currentItem.preco) : "Sob consulta";

    currentMediaList = mediaListFor(currentItem);
    mediaIndex = 0;
    renderViewer();
    el("modalItemBack").style.display = "flex";
  }

  function closeItem(){
    el("modalItemBack").style.display = "none";
    currentItem = null;
  }

  el("closeItem").addEventListener("click", closeItem);
  el("modalItemBack").addEventListener("click",(e)=>{
    if(e.target === el("modalItemBack")) closeItem();
  });

  el("prevMedia").addEventListener("click", ()=>{
    if(!currentMediaList.length) return;
    mediaIndex = (mediaIndex - 1 + currentMediaList.length) % currentMediaList.length;
    renderViewer();
  });
  el("nextMedia").addEventListener("click", ()=>{
    if(!currentMediaList.length) return;
    mediaIndex = (mediaIndex + 1) % currentMediaList.length;
    renderViewer();
  });

  el("addCart").addEventListener("click", ()=>{
    if(!currentItem) return;
    const n = state.cart.get(currentItem.id) || 0;
    state.cart.set(currentItem.id, n+1);
    render();
  });
  el("removeCart").addEventListener("click", ()=>{
    if(!currentItem) return;
    const n = state.cart.get(currentItem.id) || 0;
    if(n<=1) state.cart.delete(currentItem.id);
    else state.cart.set(currentItem.id, n-1);
    render();
  });

  // ========= CONTRATO + ASSINATURA =========
  function openContract(){ el("modalContractBack").style.display="flex"; }
  function closeContract(){ el("modalContractBack").style.display="none"; }
  el("btnContract").addEventListener("click", openContract);
  el("closeContract").addEventListener("click", closeContract);
  el("modalContractBack").addEventListener("click",(e)=>{
    if(e.target === el("modalContractBack")) closeContract();
  });

  const canvas = el("sign");
  const ctx = canvas.getContext("2d");
  let drawing = false;
  let hasStroke = false;

  function resizeCanvas(){
    const r = canvas.getBoundingClientRect();
    const dpr = window.devicePixelRatio || 1;
    canvas.width = Math.floor(r.width * dpr);
    canvas.height = Math.floor(r.height * dpr);
    ctx.setTransform(dpr, 0, 0, dpr, 0, 0);
    ctx.lineWidth = 2.4;
    ctx.lineCap = "round";
    ctx.strokeStyle = "rgba(255,255,255,.92)";
  }
  setTimeout(resizeCanvas, 60);
  window.addEventListener("resize", ()=> setTimeout(resizeCanvas, 60));

  function pos(e){
    const r = canvas.getBoundingClientRect();
    const x = (e.touches ? e.touches[0].clientX : e.clientX) - r.left;
    const y = (e.touches ? e.touches[0].clientY : e.clientY) - r.top;
    return {x,y};
  }

  function down(e){
    drawing = true;
    hasStroke = true;
    const p = pos(e);
    ctx.beginPath();
    ctx.moveTo(p.x, p.y);
    e.preventDefault();
  }
  function move(e){
    if(!drawing) return;
    const p = pos(e);
    ctx.lineTo(p.x, p.y);
    ctx.stroke();
    e.preventDefault();
  }
  function up(){ drawing = false; }

  canvas.addEventListener("mousedown", down);
  canvas.addEventListener("mousemove", move);
  window.addEventListener("mouseup", up);

  canvas.addEventListener("touchstart", down, {passive:false});
  canvas.addEventListener("touchmove", move, {passive:false});
  window.addEventListener("touchend", up);

  el("clearSign").addEventListener("click", ()=>{
    ctx.clearRect(0,0,canvas.width,canvas.height);
    hasStroke = false;
    state.contractOk = false;
    el("signStatus").innerHTML = '<div class="verseTitle">Status</div><p class="verseText" style="margin:0;">Aguardando aceite.</p>';
  });

  el("saveSign").addEventListener("click", ()=>{
    const agreed = el("agree").checked;
    if(!agreed){
      el("signStatus").innerHTML = '<div class="verseTitle">Status</div><p class="verseText" style="margin:0;">Marque "Li e concordo" para salvar.</p>';
      return;
    }
    if(!hasStroke){
      el("signStatus").innerHTML = '<div class="verseTitle">Status</div><p class="verseText" style="margin:0;">Assine no quadro para salvar.</p>';
      return;
    }
    state.contractOk = true;
    el("signStatus").innerHTML = '<div class="verseTitle">Status</div><p class="verseText" style="margin:0;">Aceite salvo ‚úÖ</p>';
    closeContract();
  });

  // ========= A√á√ïES =========
  el("btnWhats").addEventListener("click", ()=>{
    const url = `https://wa.me/${CONFIG.whatsappNumber}?text=${encodeURIComponent("Ol√°! Quero informa√ß√µes sobre os itens do cat√°logo da Faz de Conta Decora√ß√µes.")}`;
    window.open(url, "_blank");
  });

  el("btnCart").addEventListener("click", ()=>{
    const totalItens = [...state.cart.values()].reduce((a,b)=>a+b,0);
    alert("Carrinho: " + totalItens + " item(ns).");
  });

  el("btnFinish").addEventListener("click", ()=>{
    if(!state.contractOk){
      alert("Antes de finalizar, abra o CONTRATO e salve o aceite com assinatura.");
      openContract();
      return;
    }
    const totalItens = [...state.cart.values()].reduce((a,b)=>a+b,0);
    if(totalItens<=0){
      alert("Seu carrinho est√° vazio. Clique em um item e adicione ao carrinho.");
      return;
    }
    alert("Finalizar (Pix):\n(Pr√≥ximo passo: gerar Pix Copia e Cola.)");
  });

  // ========= VERS√çCULO DO DIA =========
  const VERSES = [
    { ref:"Romanos 12:12", text:"Alegrai-vos na esperan√ßa, sede pacientes na tribula√ß√£o, perseverai na ora√ß√£o." },
    { ref:"Salmos 23:1", text:"O Senhor √© o meu pastor; nada me faltar√°." },
    { ref:"Prov√©rbios 3:5", text:"Confia no Senhor de todo o teu cora√ß√£o e n√£o te estribes no teu pr√≥prio entendimento." },
    { ref:"Isa√≠as 41:10", text:"N√£o temas, porque eu sou contigo; n√£o te assombres, porque eu sou o teu Deus." },
    { ref:"Filipenses 4:13", text:"Tudo posso naquele que me fortalece." },
    { ref:"Salmos 46:1", text:"Deus √© o nosso ref√∫gio e fortaleza, socorro bem presente na ang√∫stia." },
    { ref:"Mateus 11:28", text:"Vinde a mim, todos os que estais cansados e oprimidos, e eu vos aliviarei." },
    { ref:"Jo√£o 14:27", text:"Deixo-vos a paz, a minha paz vos dou; n√£o vo-la dou como o mundo a d√°." }
  ];
  function dayOfYear(d){
    const start = new Date(d.getFullYear(), 0, 0);
    const diff = d - start;
    return Math.floor(diff / 86400000);
  }
  function setVerseOfDay(){
    const d = new Date();
    const idx = dayOfYear(d) % VERSES.length;
    const v = VERSES[idx];
    el("verseText").textContent = `"${v.text}"`;
    el("verseRef").textContent = v.ref;
  }
  setVerseOfDay();

  // ========= MONTADOR (arrastar + camadas + tamanho) =========
  const builder = el("builder");
  const pieces = [...document.querySelectorAll(".piece")];
  const layerList = el("layerList");
  const scaleRange = el("scaleRange");
  const scaleLabel = el("scaleLabel");
  const btnFront = el("btnFront");
  const btnBack = el("btnBack");
  const btnResetBuild = el("btnResetBuild");
  const btnPrintHint = el("btnPrintHint");

  const prettyName = {
    cilindros: "Cilindros",
    arco: "Arco",
    cortina: "Cortina LED",
    tapete: "Tapete",
    item: "Item decorativo"
  };

  // posi√ß√µes iniciais (relativas)
  const defaultPos = {
    cortina:   { rx: 0.00, ry: -0.02, s: 1.00, z: 1 },
    arco:      { rx: 0.00, ry: -0.10, s: 0.92, z: 3 },
    cilindros: { rx: 0.00, ry:  0.18, s: 0.62, z: 4 },
    tapete:    { rx: 0.00, ry:  0.30, s: 0.92, z: 2 },
    item:      { rx: 0.20, ry:  0.18, s: 0.35, z: 5 }
  };

  function applyPieceTransform(img){
    const x = Number(img.dataset.x || 0);
    const y = Number(img.dataset.y || 0);
    const s = Number(img.dataset.s || 1);
    img.style.transform = `translate(calc(-50% + ${x}px), calc(-50% + ${y}px)) scale(${s})`;
  }

  function syncRelativeToPixels(){
    const r = builder.getBoundingClientRect();
    pieces.forEach(img=>{
      const rx = Number(img.dataset.rx || 0);
      const ry = Number(img.dataset.ry || 0);
      img.dataset.x = rx * r.width;
      img.dataset.y = ry * r.height;
      applyPieceTransform(img);
    });
  }

  window.addEventListener("resize", ()=>{ syncRelativeToPixels(); });

  function resetBuilder(){
    pieces.forEach(img=>{
      const key = img.dataset.piece;
      const d = defaultPos[key] || {rx:0,ry:0,s:1,z:1};
      img.dataset.rx = d.rx;
      img.dataset.ry = d.ry;
      img.dataset.s = d.s;
      img.style.zIndex = String(d.z);
    });
    syncRelativeToPixels();
    setActivePiece(null);
    updateLayerUI();
    scaleRange.value = "100";
    scaleLabel.textContent = "100%";
  }

  // monta lista de camadas
  function updateLayerUI(){
    layerList.innerHTML = "";
    const visible = pieces.filter(p=>!p.classList.contains("hidden"));
    visible
      .sort((a,b)=>Number(a.style.zIndex||0) - Number(b.style.zIndex||0))
      .forEach(p=>{
        const key = p.dataset.piece;

        const row = document.createElement("div");
        row.className = "layerRow" + (activePiece===p ? " active" : "");
        row.addEventListener("click", ()=> setActivePiece(p));

        const left = document.createElement("div");
        left.className = "layerLeft";

        const dot = document.createElement("div");
        dot.className = "dot";
        dot.style.background = (key==="arco") ? "rgba(255,217,74,.35)"
                          : (key==="cilindros") ? "rgba(0,255,213,.25)"
                          : (key==="tapete") ? "rgba(122,66,255,.25)"
                          : (key==="cortina") ? "rgba(255,75,216,.25)"
                          : "rgba(255,255,255,.18)";

        const nm = document.createElement("div");
        nm.className = "layerName";
        nm.textContent = prettyName[key] || key;

        left.appendChild(dot);
        left.appendChild(nm);

        const eye = document.createElement("button");
        eye.className = "miniBtn";
        eye.type = "button";
        eye.textContent = "üëÅ";
        eye.title = "Mostrar/ocultar";
        eye.addEventListener("click",(e)=>{
          e.stopPropagation();
          const hidden = p.style.opacity === "0";
          p.style.opacity = hidden ? "" : "0";
          p.style.pointerEvents = hidden ? "" : "none";
        });

        row.appendChild(left);
        row.appendChild(eye);
        layerList.appendChild(row);
      });

    // se n√£o tem nada no carrinho
    if(visible.length === 0){
      const hint = document.createElement("div");
      hint.className = "bpHint";
      hint.textContent = "Adicione itens no cat√°logo para aparecerem aqui na montagem.";
      layerList.appendChild(hint);
    }
  }

  // mostrar/ocultar pe√ßas conforme carrinho
  function updateBuilderFromCart(){
    pieces.forEach(img=>{
      const key = img.dataset.piece;
      const has = (state.cart.get(key) || 0) > 0;
      img.classList.toggle("hidden", !has);
      // se voltou a aparecer, restaura opacity/pointer
      if(has){
        img.style.opacity = "";
        img.style.pointerEvents = "";
      }
    });

    // garante que item ativo n√£o sumiu
    if(activePiece && activePiece.classList.contains("hidden")){
      setActivePiece(null);
    }
    updateLayerUI();
  }

  // sele√ß√£o ativa
  let activePiece = null;
  function setActivePiece(img){
    pieces.forEach(p=>p.classList.remove("active"));
    activePiece = img;
    if(img){
      img.classList.add("active");
      const s = Number(img.dataset.s || 1);
      const pct = Math.round(s * 100);
      scaleRange.value = String(pct);
      scaleLabel.textContent = pct + "%";
    }
    updateLayerUI();
  }

  // drag pointer
  let dragging = false;
  let startX=0, startY=0, baseX=0, baseY=0;

  builder.addEventListener("pointerdown",(e)=>{
    const img = e.target.closest(".piece");
    if(!img || img.classList.contains("hidden")) return;
    dragging = true;
    setActivePiece(img);
    img.setPointerCapture?.(e.pointerId);

    startX = e.clientX;
    startY = e.clientY;
    baseX = Number(img.dataset.x || 0);
    baseY = Number(img.dataset.y || 0);
  });

  builder.addEventListener("pointermove",(e)=>{
    if(!dragging || !activePiece) return;
    const dx = e.clientX - startX;
    const dy = e.clientY - startY;

    const r = builder.getBoundingClientRect();
    const nx = Math.max(-r.width*0.46, Math.min(r.width*0.46, baseX + dx));
    const ny = Math.max(-r.height*0.46, Math.min(r.height*0.46, baseY + dy));

    activePiece.dataset.x = nx;
    activePiece.dataset.y = ny;
    activePiece.dataset.rx = nx / r.width;
    activePiece.dataset.ry = ny / r.height;
    applyPieceTransform(activePiece);
  });

  window.addEventListener("pointerup", ()=>{ dragging = false; });

  // escala
  scaleRange.addEventListener("input", ()=>{
    if(!activePiece) return;
    const pct = Number(scaleRange.value || 100);
    const s = pct / 100;
    activePiece.dataset.s = s;
    scaleLabel.textContent = pct + "%";
    applyPieceTransform(activePiece);
  });

  // camadas
  function bringFront(){
    if(!activePiece) return;
    const maxZ = Math.max(...pieces.map(p=>Number(p.style.zIndex||0)));
    activePiece.style.zIndex = String(maxZ + 1);
    updateLayerUI();
  }
  function sendBack(){
    if(!activePiece) return;
    const minZ = Math.min(...pieces.map(p=>Number(p.style.zIndex||0)));
    activePiece.style.zIndex = String(minZ - 1);
    updateLayerUI();
  }
  btnFront.addEventListener("click", bringFront);
  btnBack.addEventListener("click", sendBack);

  btnResetBuild.addEventListener("click", ()=> resetBuilder());
  btnPrintHint.addEventListener("click", ()=> alert("Dica: tire um print (captura de tela) para salvar a montagem e enviar no WhatsApp üôÇ"));

  // inicializa montador
  resetBuilder();
  updateBuilderFromCart();

  // ========= IMPORTANTE: atualiza montador quando mexe no carrinho do modal =========
  // (o render() j√° chama updateBuilderFromCart, mas isso garante instant√¢neo)
  el("addCart").addEventListener("click", ()=> setTimeout(updateBuilderFromCart, 0));
  el("removeCart").addEventListener("click", ()=> setTimeout(updateBuilderFromCart, 0));
</script>

</body>
</html>
