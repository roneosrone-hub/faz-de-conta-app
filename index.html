<!doctype html>
<html lang="pt-br">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Faz de Conta Decora√ß√µes ‚Ä¢ Montagem</title>

  <style>
    :root{
      --bg0:#070916;
      --bg1:#0b1230;
      --card: rgba(255,255,255,.08);
      --card2: rgba(255,255,255,.06);
      --stroke: rgba(255,255,255,.14);
      --text: rgba(255,255,255,.92);
      --muted: rgba(255,255,255,.70);
      --muted2: rgba(255,255,255,.45);
      --shadow: 0 18px 55px rgba(0,0,0,.55);
      --radius: 22px;
      --radius2: 18px;

      --accentA:#ff4ecd;
      --accentB:#5fe7ff;
      --accentC:#7cff7e;
    }

    *{ box-sizing:border-box; }
    html,body{ height:100%; }
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, "Noto Sans", "Helvetica Neue";
      background: radial-gradient(1100px 600px at 15% 10%, rgba(255,78,205,.16), transparent 55%),
                  radial-gradient(1000px 650px at 85% 20%, rgba(95,231,255,.14), transparent 55%),
                  radial-gradient(900px 700px at 40% 95%, rgba(124,255,126,.10), transparent 55%),
                  linear-gradient(180deg, var(--bg0), var(--bg1));
      color: var(--text);
    }

    .wrap{
      width:min(1250px, 94vw);
      margin: 18px auto 30px;
      display:flex;
      flex-direction:column;
      gap:14px;
    }

    .topline{
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:10px;
      opacity:.95;
    }

    .chip{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding:7px 11px;
      border-radius:999px;
      background: rgba(255,255,255,.06);
      border: 1px solid rgba(255,255,255,.10);
      color: var(--muted);
      font-size:12px;
      backdrop-filter: blur(10px);
    }
    .chip b{ color: var(--text); font-weight:700; }
    .spark{
      width:10px;height:10px;border-radius:99px;
      background: linear-gradient(135deg, var(--accentA), var(--accentB));
      box-shadow: 0 0 18px rgba(255,78,205,.35);
    }

    .hero{
      display:grid;
      grid-template-columns: 1.05fr .95fr;
      gap:14px;
    }

    .card{
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.04));
      border: 1px solid rgba(255,255,255,.11);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      backdrop-filter: blur(10px);
      overflow:hidden;
    }

    .brand{
      padding:16px;
      display:grid;
      grid-template-columns: 110px 1fr;
      gap:14px;
      align-items:center;
      position:relative;
    }

    .logoBox{
      width:110px;height:110px;border-radius:18px;
      background: radial-gradient(90px 90px at 30% 25%, rgba(255,78,205,.25), transparent 60%),
                  radial-gradient(90px 90px at 75% 60%, rgba(95,231,255,.20), transparent 60%),
                  rgba(255,255,255,.05);
      border: 1px solid rgba(255,255,255,.14);
      display:grid;
      place-items:center;
      position:relative;
      overflow:hidden;
    }

    .logoMark{
      width:74px;height:74px;border-radius:20px;
      background: linear-gradient(135deg, rgba(255,78,205,.95), rgba(95,231,255,.95));
      box-shadow: 0 18px 40px rgba(0,0,0,.35);
      position:relative;
      transform: rotate(-6deg);
    }
    .logoMark:after{
      content:"FC";
      position:absolute; inset:0;
      display:grid; place-items:center;
      font-weight:900;
      letter-spacing:.6px;
      color: rgba(5,8,22,.88);
      font-size:28px;
    }

    .title{
      display:flex;
      flex-direction:column;
      gap:6px;
      min-width:0;
    }
    .title h1{
      margin:0;
      font-size: clamp(22px, 2.8vw, 34px);
      letter-spacing:.5px;
      line-height:1.05;
      background: linear-gradient(90deg, var(--accentA), var(--accentB), var(--accentC));
      -webkit-background-clip:text;
      background-clip:text;
      color:transparent;
      text-shadow: 0 10px 30px rgba(0,0,0,.35);
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }
    .title .slogan{
      display:flex;
      align-items:center;
      gap:8px;
      color: rgba(255,255,255,.90);
      font-weight:800;
      letter-spacing:.2px;
      opacity:.92;
      text-shadow: 0 12px 26px rgba(0,0,0,.45);
      font-size: 14px;
      flex-wrap:wrap;
    }
    .star{
      width:14px;height:14px;
      filter: drop-shadow(0 10px 18px rgba(0,0,0,.55));
    }

    .actions{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      margin-top:6px;
    }
    .btn{
      appearance:none;
      border:none;
      border-radius:999px;
      padding:10px 12px;
      background: rgba(255,255,255,.06);
      border:1px solid rgba(255,255,255,.12);
      color: rgba(255,255,255,.92);
      font-weight:800;
      cursor:pointer;
      display:inline-flex;
      align-items:center;
      gap:8px;
      transition: transform .08s ease, background .15s ease, border .15s ease;
      user-select:none;
      font-size: 13px;
    }
    .btn:hover{ background: rgba(255,255,255,.085); border-color: rgba(255,255,255,.18); }
    .btn:active{ transform: scale(.985); }
    .btn.primary{
      background: linear-gradient(90deg, rgba(255,78,205,.22), rgba(95,231,255,.18));
      border-color: rgba(255,255,255,.18);
    }
    .btn.good{
      background: linear-gradient(90deg, rgba(124,255,126,.22), rgba(95,231,255,.16));
      border-color: rgba(255,255,255,.18);
    }
    .btn.warn{
      background: linear-gradient(90deg, rgba(255,170,74,.20), rgba(255,78,205,.14));
      border-color: rgba(255,255,255,.18);
    }

    .rightPanel{
      padding:16px;
      display:flex;
      flex-direction:column;
      gap:12px;
    }
    .panelTitle{
      font-weight:900;
      letter-spacing:.2px;
      font-size:16px;
      display:flex;
      align-items:center;
      gap:10px;
    }
    .panelTitle small{
      color: var(--muted2);
      font-weight:700;
      margin-left:auto;
    }
    .field{
      display:flex;
      gap:10px;
      align-items:center;
      background: rgba(0,0,0,.18);
      border: 1px solid rgba(255,255,255,.10);
      border-radius: 14px;
      padding: 10px 12px;
    }
    .field input, .field select{
      width:100%;
      background: transparent;
      border: none;
      outline: none;
      color: var(--text);
      font-weight:700;
      font-size: 13px;
    }
    .field input::placeholder{ color: rgba(255,255,255,.35); }
    .hint{
      color: rgba(255,255,255,.55);
      font-size:12px;
      line-height:1.35;
      margin-top:-4px;
    }

    /* Montagem + Controles */
    .studio{
      display:grid;
      grid-template-columns: 1fr;
      gap:14px;
    }
    .studioRow{
      display:grid;
      grid-template-columns: 1fr;
      gap:14px;
    }
    .montagemCard{
      padding:12px;
    }
    .montagemHead{
      display:flex;
      align-items:center;
      gap:10px;
      padding:8px 10px 12px;
      color: rgba(255,255,255,.85);
      font-weight:900;
    }
    .montagemHead .miniTip{
      margin-left:auto;
      color: rgba(255,255,255,.42);
      font-weight:700;
      font-size:12px;
      text-align:right;
      line-height:1.2;
    }

    #stage{
      height: 430px;
      border-radius: 16px;
      background:
        radial-gradient(900px 500px at 20% 15%, rgba(255,78,205,.12), transparent 55%),
        radial-gradient(850px 540px at 85% 25%, rgba(95,231,255,.10), transparent 55%),
        linear-gradient(180deg, rgba(255,255,255,.05), rgba(255,255,255,.03));
      border: 1px solid rgba(255,255,255,.11);
      box-shadow: inset 0 0 0 1px rgba(0,0,0,.25);
      overflow:hidden;
      position:relative;
      touch-action:none;
    }

    .ghost{
      position:absolute; inset:0;
      display:grid;
      place-items:center;
      pointer-events:none;
      opacity:.40;
      font-weight:900;
      letter-spacing:.2px;
      color: rgba(255,255,255,.20);
      text-shadow: 0 14px 30px rgba(0,0,0,.55);
    }

    .obj{
      position:absolute;
      left: 30px; top: 30px;
      width: 220px;
      transform: translate3d(0,0,0);
      cursor: grab;
      user-select:none;
      touch-action:none;
      filter: drop-shadow(0 16px 26px rgba(0,0,0,.45));
    }
    .obj:active{ cursor: grabbing; }
    .obj.selected{
      outline: 2px solid rgba(95,231,255,.35);
      outline-offset: 8px;
      border-radius: 14px;
    }

    .controls{
      padding:12px;
      display:grid;
      gap:10px;
    }
    .controlsGrid{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:10px;
    }

    .ctl{
      background: rgba(0,0,0,.18);
      border: 1px solid rgba(255,255,255,.10);
      border-radius: 14px;
      padding: 10px 12px;
    }
    .ctl label{
      display:flex;
      justify-content:space-between;
      font-size:12px;
      color: rgba(255,255,255,.65);
      font-weight:800;
      margin-bottom:6px;
    }
    .ctl input[type="range"]{
      width:100%;
      accent-color: #5fe7ff;
    }
    .ctlRow{
      display:flex;
      gap:10px;
      align-items:center;
      flex-wrap:wrap;
    }
    .ctlRow .btn{ flex:1; justify-content:center; }
    .colorRow{
      display:flex;
      gap:10px;
      align-items:center;
      flex-wrap:wrap;
    }
    .colorRow input[type="color"]{
      width:50px;height:42px;
      border:none;
      background: transparent;
      padding:0;
      cursor:pointer;
    }
    .toggle{
      display:flex;
      align-items:center;
      gap:10px;
      flex:1;
      padding:10px 12px;
      border-radius:14px;
      background: rgba(255,255,255,.06);
      border: 1px solid rgba(255,255,255,.10);
      color: rgba(255,255,255,.88);
      font-weight:900;
      cursor:pointer;
      user-select:none;
    }
    .toggle small{
      color: rgba(255,255,255,.48);
      font-weight:800;
      margin-left:auto;
    }
    .sw{
      width:44px;height:26px;border-radius:999px;
      background: rgba(255,255,255,.18);
      border: 1px solid rgba(255,255,255,.16);
      position:relative;
      flex:0 0 auto;
    }
    .sw::after{
      content:"";
      width:20px;height:20px;border-radius:999px;
      position:absolute; top:2px; left:2px;
      background: rgba(255,255,255,.90);
      transition: left .16s ease;
      box-shadow: 0 10px 18px rgba(0,0,0,.45);
    }
    .toggle.on .sw{
      background: rgba(95,231,255,.26);
      border-color: rgba(95,231,255,.35);
    }
    .toggle.on .sw::after{ left:22px; }

    /* Cat√°logo */
    .catalog{
      padding:12px;
    }
    .catHead{
      display:flex;
      align-items:center;
      justify-content:space-between;
      padding: 6px 8px 10px;
      gap:10px;
    }
    .catHead h3{
      margin:0;
      font-size:14px;
      font-weight:900;
      letter-spacing:.2px;
      color: rgba(255,255,255,.86);
    }
    .count{
      font-size:12px;
      color: rgba(255,255,255,.50);
      font-weight:800;
    }
    .grid{
      display:grid;
      grid-template-columns: repeat(2, minmax(0,1fr));
      gap:12px;
    }
    .tile{
      border-radius: 16px;
      background: rgba(255,255,255,.05);
      border: 1px solid rgba(255,255,255,.10);
      overflow:hidden;
      cursor:pointer;
      transition: transform .08s ease, border .15s ease, background .15s ease;
      box-shadow: 0 16px 40px rgba(0,0,0,.35);
    }
    .tile:hover{ transform: translateY(-1px); border-color: rgba(255,255,255,.16); background: rgba(255,255,255,.07); }
    .tile:active{ transform: translateY(0); }
    .thumb{
      height: 122px;
      display:grid;
      place-items:center;
      position:relative;
      background:
        radial-gradient(140px 90px at 40% 30%, rgba(255,78,205,.12), transparent 65%),
        radial-gradient(140px 90px at 70% 70%, rgba(95,231,255,.10), transparent 65%),
        rgba(0,0,0,.18);
      border-bottom: 1px solid rgba(255,255,255,.08);
    }
    .thumb svg{ width: 92%; height: 92%; }
    .meta{
      padding:10px 10px 12px;
      display:flex;
      flex-direction:column;
      gap:6px;
    }
    .meta b{
      font-size:13px;
      font-weight:900;
      color: rgba(255,255,255,.90);
      line-height:1.15;
    }
    .meta span{
      color: rgba(255,255,255,.55);
      font-size:12px;
      line-height:1.2;
    }

    @media (max-width: 980px){
      .hero{ grid-template-columns: 1fr; }
      .grid{ grid-template-columns: 1fr; }
      #stage{ height: 420px; }
      .controlsGrid{ grid-template-columns: 1fr; }
    }
  </style>
</head>

<body>
  <div class="wrap">

    <div class="topline">
      <div class="chip"><span class="spark"></span> <b>Faz de Conta</b> ‚Ä¢ Montagem interativa</div>
      <div class="chip">üìç <b>Jaciara/MT</b> ‚Ä¢ WhatsApp <b>(66) 99622-3481</b></div>
    </div>

    <section class="hero">
      <div class="card brand">
        <div class="logoBox">
          <div class="logoMark"></div>
        </div>
        <div class="title">
          <h1>FAZ DE CONTA DECORA√á√ïES</h1>
          <div class="slogan">
            <svg class="star" viewBox="0 0 24 24" fill="none">
              <path d="M12 2l2.2 6.7H21l-5.4 3.9 2.1 6.7L12 15.7 6.3 19.3l2.1-6.7L3 8.7h6.8L12 2z" fill="rgba(255,255,255,.92)"/>
            </svg>
            Onde a imagina√ß√£o vira festa
          </div>

          <div class="actions">
            <button class="btn primary" id="btnWhats">üí¨ WhatsApp</button>
            <button class="btn" id="btnCarrinho">üõí Carrinho <span id="cartCount" style="opacity:.8;font-weight:900">(0)</span></button>
            <button class="btn warn" id="btnLimpar">üßπ Limpar montagem</button>
            <button class="btn good" id="btnFinalizar">‚úÖ Finalizar (Pix)</button>
          </div>
        </div>
      </div>

      <div class="card rightPanel">
        <div class="panelTitle">Monte seu pedido <small>clique ‚Üí entra na montagem</small></div>

        <div class="field">
          üîé
          <input id="q" type="text" placeholder="Pesquisar (ex: bal√µes, arco, LED, tapete...)" />
        </div>

        <div class="field">
          üß©
          <select id="cat">
            <option value="all">Todas as categorias</option>
            <option value="baloes">Bal√µes</option>
            <option value="estruturas">Estruturas</option>
            <option value="fundos">Fundos / LED</option>
            <option value="base">Base / Tapetes</option>
          </select>
        </div>

        <div class="hint">
          üí° Dica: depois que o item entrar na montagem, voc√™ pode <b>arrastar</b>, <b>mudar tamanho</b>, <b>girar</b> e <b>trocar cor</b>.
          <br/>Nos bal√µes d√° pra trocar cor <b>do conjunto</b> ou <b>por bol√£o</b>.
        </div>
      </div>
    </section>

    <section class="studio">
      <div class="card montagemCard">
        <div class="montagemHead">
          üß© Montagem do cliente
          <div class="miniTip">
            Toque/clique em um item pra selecionar.<br/>
            Arraste com dedo/mouse.
          </div>
        </div>

        <div id="stage">
          <div class="ghost">Solte os itens aqui ‚ú®</div>
        </div>
      </div>

      <div class="card controls">
        <div style="display:flex;align-items:center;gap:10px;padding:4px 6px;">
          <div style="font-weight:900;letter-spacing:.2px;">üéõÔ∏è Ajustes do item selecionado</div>
          <div id="selName" style="margin-left:auto;color:rgba(255,255,255,.55);font-weight:800;font-size:12px;">Nenhum item selecionado</div>
        </div>

        <div class="controlsGrid">
          <div class="ctl">
            <label><span>Escala</span><b id="vScale">100%</b></label>
            <input id="scale" type="range" min="20" max="220" value="100">
          </div>

          <div class="ctl">
            <label><span>Rota√ß√£o</span><b id="vRot">0¬∞</b></label>
            <input id="rot" type="range" min="-180" max="180" value="0">
          </div>

          <div class="ctl">
            <label><span>Opacidade</span><b id="vOp">100%</b></label>
            <input id="op" type="range" min="10" max="100" value="100">
          </div>

          <div class="ctl">
            <label><span>Camadas</span><b>Organizar</b></label>
            <div class="ctlRow">
              <button class="btn" id="toFront">‚¨ÜÔ∏è Frente</button>
              <button class="btn" id="toBack">‚¨áÔ∏è Fundo</button>
            </div>
          </div>
        </div>

        <div class="ctl">
          <label><span>Cor</span><b>realista (sem ‚Äúfoto‚Äù)</b></label>
          <div class="colorRow">
            <input id="color" type="color" value="#4aa8ff" />
            <div class="toggle" id="unitToggle" title="Nos bal√µes: trocar cor por bol√£o (unidade)">
              <div class="sw"></div>
              Cor por unidade <small>bal√µes</small>
            </div>
            <button class="btn" id="resetColor">‚Ü©Ô∏è Reset cor</button>
          </div>
          <div class="hint" style="margin-top:8px;">
            Se <b>Cor por unidade</b> estiver ligada e o item for <b>bal√µes</b>, toque em um bol√£o pra pintar s√≥ ele.
          </div>
        </div>

        <div class="ctl">
          <label><span>A√ß√µes</span><b>r√°pido</b></label>
          <div class="ctlRow">
            <button class="btn" id="dup">üìå Duplicar</button>
            <button class="btn warn" id="del">üóëÔ∏è Apagar</button>
            <button class="btn primary" id="center">üéØ Centralizar</button>
          </div>
        </div>
      </div>

      <div class="card catalog">
        <div class="catHead">
          <h3>‚ú® Itens do cat√°logo (clique para jogar na montagem)</h3>
          <div class="count"><span id="shownCount">0</span> itens</div>
        </div>
        <div class="grid" id="grid"></div>
      </div>
    </section>

  </div>

  <script>
    // ====== √çCONES (SVG REALISTA SEM FOTO) ======
    // Tudo inline (n√£o some no Vercel). Miniaturas e itens de montagem usam o MESMO SVG.
    const SVGS = {
      balloons: (palette) => `
        <svg viewBox="0 0 520 520" xmlns="http://www.w3.org/2000/svg">
          <defs>
            <radialGradient id="g1" cx="35%" cy="30%" r="65%">
              <stop offset="0%" stop-color="${shade(palette.a, 35)}" stop-opacity="1"/>
              <stop offset="55%" stop-color="${palette.a}" stop-opacity="1"/>
              <stop offset="100%" stop-color="${shade(palette.a, -25)}" stop-opacity="1"/>
            </radialGradient>
            <radialGradient id="g2" cx="35%" cy="30%" r="65%">
              <stop offset="0%" stop-color="${shade(palette.b, 35)}" stop-opacity="1"/>
              <stop offset="55%" stop-color="${palette.b}" stop-opacity="1"/>
              <stop offset="100%" stop-color="${shade(palette.b, -25)}" stop-opacity="1"/>
            </radialGradient>
            <filter id="soft" x="-20%" y="-20%" width="140%" height="140%">
              <feGaussianBlur stdDeviation="0.8" result="b"/>
              <feMerge><feMergeNode in="b"/><feMergeNode in="SourceGraphic"/></feMerge>
            </filter>
          </defs>

          <!-- arco org√¢nico (v√°rias bolinhas clic√°veis) -->
          <g filter="url(#soft)">
            ${balloonCircle(120,390,95,"a")}
            ${balloonCircle(190,410,78,"b")}
            ${balloonCircle(260,415,62,"a")}
            ${balloonCircle(310,450,58,"b")}
            ${balloonCircle(360,455,86,"b")}

            ${balloonCircle(140,300,88,"a")}
            ${balloonCircle(230,310,86,"a")}
            ${balloonCircle(315,320,74,"b")}
            ${balloonCircle(400,310,65,"a")}
            ${balloonCircle(445,265,58,"a")}

            ${balloonCircle(170,210,84,"a")}
            ${balloonCircle(250,205,70,"b")}
            ${balloonCircle(320,220,94,"a")}
            ${balloonCircle(410,205,76,"b")}
            ${balloonCircle(460,165,64,"a")}

            ${balloonCircle(235,135,88,"b")}
            ${balloonCircle(325,120,82,"a")}
            ${balloonCircle(400,120,70,"b")}
            ${balloonCircle(455,105,60,"a")}

            ${balloonCircle(305,70,74,"a")}
            ${balloonCircle(375,60,88,"b")}
          </g>
        </svg>
      `,

      roundArch: (metal="#d8b35a") => `
        <svg viewBox="0 0 520 520" xmlns="http://www.w3.org/2000/svg">
          <defs>
            <linearGradient id="m" x1="0" y1="0" x2="1" y2="1">
              <stop offset="0%" stop-color="${shade(metal, 25)}"/>
              <stop offset="50%" stop-color="${metal}"/>
              <stop offset="100%" stop-color="${shade(metal, -25)}"/>
            </linearGradient>
            <filter id="glow" x="-30%" y="-30%" width="160%" height="160%">
              <feDropShadow dx="0" dy="6" stdDeviation="8" flood-color="rgba(0,0,0,.45)"/>
            </filter>
          </defs>
          <g filter="url(#glow)">
            <circle cx="260" cy="230" r="190" fill="none" stroke="url(#m)" stroke-width="16"/>
            <rect x="165" y="430" width="190" height="18" rx="9" fill="url(#m)"/>
            <rect x="170" y="440" width="18" height="60" rx="9" fill="url(#m)"/>
            <rect x="332" y="440" width="18" height="60" rx="9" fill="url(#m)"/>
          </g>
        </svg>
      `,

      ledCurtain: (warm=false) => `
        <svg viewBox="0 0 520 520" xmlns="http://www.w3.org/2000/svg">
          <defs>
            <filter id="ledGlow" x="-40%" y="-40%" width="180%" height="180%">
              <feDropShadow dx="0" dy="0" stdDeviation="4" flood-color="${warm ? 'rgba(255,201,92,.65)' : 'rgba(220,245,255,.70)'}"/>
            </filter>
          </defs>
          <rect x="40" y="80" width="440" height="360" rx="18" fill="rgba(255,255,255,.04)" stroke="rgba(255,255,255,.10)"/>
          ${[70,115,160,205,250,295,340,385,430].map(x=>ledStrand(x, warm)).join("")}
        </svg>
      `,

      carpet: (c="#ff7fd1") => `
        <svg viewBox="0 0 520 520" xmlns="http://www.w3.org/2000/svg">
          <defs>
            <linearGradient id="car" x1="0" y1="0" x2="1" y2="1">
              <stop offset="0%" stop-color="${shade(c, 25)}"/>
              <stop offset="55%" stop-color="${c}"/>
              <stop offset="100%" stop-color="${shade(c, -22)}"/>
            </linearGradient>
            <filter id="fur" x="-20%" y="-20%" width="140%" height="140%">
              <feTurbulence type="fractalNoise" baseFrequency=".9" numOctaves="2" seed="8" result="n"/>
              <feDisplacementMap in="SourceGraphic" in2="n" scale="10" xChannelSelector="R" yChannelSelector="G"/>
              <feDropShadow dx="0" dy="10" stdDeviation="10" flood-color="rgba(0,0,0,.45)"/>
            </filter>
          </defs>
          <g filter="url(#fur)">
            <rect x="70" y="120" width="380" height="280" rx="28" fill="url(#car)" stroke="rgba(255,255,255,.10)"/>
          </g>
        </svg>
      `,

      cylinders: (base="#caa7ff") => `
        <svg viewBox="0 0 520 520" xmlns="http://www.w3.org/2000/svg">
          <defs>
            <linearGradient id="cx" x1="0" y1="0" x2="1" y2="1">
              <stop offset="0%" stop-color="${shade(base, 18)}"/>
              <stop offset="55%" stop-color="${base}"/>
              <stop offset="100%" stop-color="${shade(base, -20)}"/>
            </linearGradient>
          </defs>
          <g>
            <ellipse cx="190" cy="260" rx="80" ry="20" fill="rgba(0,0,0,.25)"/>
            <rect x="110" y="180" width="160" height="160" rx="24" fill="url(#cx)" stroke="rgba(255,255,255,.12)"/>
            <ellipse cx="190" cy="180" rx="80" ry="20" fill="${shade(base, 30)}" opacity=".95"/>

            <ellipse cx="330" cy="330" rx="92" ry="24" fill="rgba(0,0,0,.25)"/>
            <rect x="238" y="225" width="184" height="210" rx="26" fill="url(#cx)" opacity=".92" stroke="rgba(255,255,255,.12)"/>
            <ellipse cx="330" cy="225" rx="92" ry="24" fill="${shade(base, 32)}" opacity=".92"/>
          </g>
        </svg>
      `
    };

    function balloonCircle(cx, cy, r, type){
      // type "a" usa gradiente g1, type "b" usa g2
      const grad = type === "a" ? "g1" : "g2";
      return `
        <g class="balloon" data-balloon="1" data-type="${type}">
          <circle cx="${cx}" cy="${cy}" r="${r}" fill="url(#${grad})" stroke="rgba(255,255,255,.10)"/>
          <circle cx="${cx - r*0.30}" cy="${cy - r*0.30}" r="${r*0.26}" fill="rgba(255,255,255,.18)" />
        </g>
      `;
    }

    function ledStrand(x, warm){
      const dot = warm ? "rgba(255,210,120,.95)" : "rgba(235,250,255,.95)";
      const dot2 = warm ? "rgba(255,210,120,.55)" : "rgba(235,250,255,.55)";
      const y0 = 120, y1 = 400;
      const pts = [140, 175, 215, 255, 300, 340, 380].map(y=>{
        const big = Math.random() > 0.55;
        return `<circle cx="${x}" cy="${y}" r="${big?5:3.3}" fill="${dot}" filter="url(#ledGlow)"/>
                <circle cx="${x+2}" cy="${y-2}" r="${big?3:2.2}" fill="${dot2}" />`;
      }).join("");
      return `
        <g>
          <path d="M${x} ${y0} C ${x+6} ${y0+50}, ${x-6} ${y0+90}, ${x} ${y1}"
                stroke="rgba(255,255,255,.22)" stroke-width="2.2" fill="none"/>
          ${pts}
        </g>
      `;
    }

    function shade(hex, amt){
      // clareia/escurece
      hex = hex.replace("#","");
      if(hex.length===3) hex = hex.split("").map(x=>x+x).join("");
      const n = parseInt(hex,16);
      let r = (n>>16)&255, g = (n>>8)&255, b = n&255;
      r = Math.min(255, Math.max(0, r + amt));
      g = Math.min(255, Math.max(0, g + amt));
      b = Math.min(255, Math.max(0, b + amt));
      return "#" + ((1<<24) + (r<<16) + (g<<8) + b).toString(16).slice(1);
    }

    // ====== CAT√ÅLOGO ======
    const ITEMS = [
      {
        id:"baloes_arco",
        name:"Bal√µes (Arco Org√¢nico)",
        cat:"baloes",
        desc:"Miniatura realista (sem foto). Troca cor do conjunto ou por bol√£o.",
        make: ()=> SVGS.balloons({a:"#71c6ff", b:"#2f6cff"}),
        default: {scale: 120, rot: 0, op: 100},
        colorable:true,
        unitColor:true
      },
      {
        id:"arco_redondo",
        name:"Arco Redondo (Estrutura)",
        cat:"estruturas",
        desc:"Estrutura met√°lica. Combine com bal√µes/LED.",
        make: ()=> SVGS.roundArch("#d8b35a"),
        default: {scale: 110, rot: 0, op: 100},
        colorable:true,
        unitColor:false
      },
      {
        id:"cortina_led",
        name:"Cortina de LED",
        cat:"fundos",
        desc:"Fundo com brilho. Ajuste opacidade e cor/efeito.",
        make: ()=> SVGS.ledCurtain(false),
        default: {scale: 140, rot: 0, op: 85},
        colorable:true,
        unitColor:false
      },
      {
        id:"tapete",
        name:"Tapete",
        cat:"base",
        desc:"Base para fotos. Troque cor pra combinar o tema.",
        make: ()=> SVGS.carpet("#ff7fd1"),
        default: {scale: 160, rot: 0, op: 95},
        colorable:true,
        unitColor:false
      },
      {
        id:"cilindros",
        name:"Cilindros (Suporte)",
        cat:"estruturas",
        desc:"Suporte para doces/bolo. Ajuste escala e posi√ß√£o.",
        make: ()=> SVGS.cylinders("#caa7ff"),
        default: {scale: 115, rot: 0, op: 95},
        colorable:true,
        unitColor:false
      }
    ];

    const grid = document.getElementById("grid");
    const shownCount = document.getElementById("shownCount");
    const q = document.getElementById("q");
    const cat = document.getElementById("cat");

    function renderCatalog(){
      const term = (q.value || "").trim().toLowerCase();
      const c = cat.value;

      const filtered = ITEMS.filter(it=>{
        const okCat = (c==="all") || (it.cat===c);
        const okTerm = !term || (it.name.toLowerCase().includes(term) || it.desc.toLowerCase().includes(term));
        return okCat && okTerm;
      });

      shownCount.textContent = filtered.length;
      grid.innerHTML = filtered.map(it=>`
        <div class="tile" data-id="${it.id}">
          <div class="thumb">${it.make()}</div>
          <div class="meta">
            <b>${it.name}</b>
            <span>${it.desc}</span>
          </div>
        </div>
      `).join("");

      grid.querySelectorAll(".tile").forEach(el=>{
        el.addEventListener("click", ()=>{
          const id = el.getAttribute("data-id");
          addToStage(id);
          addCart(1);
        });
      });
    }

    q.addEventListener("input", renderCatalog);
    cat.addEventListener("change", renderCatalog);

    // ====== STAGE / OBJETOS ======
    const stage = document.getElementById("stage");
    const ghost = stage.querySelector(".ghost");

    let selected = null;
    let zTop = 10;

    function addToStage(id){
      const item = ITEMS.find(x=>x.id===id);
      if(!item) return;

      const wrap = document.createElement("div");
      wrap.className = "obj";
      wrap.dataset.id = item.id;
      wrap.dataset.name = item.name;
      wrap.dataset.colorable = item.colorable ? "1" : "0";
      wrap.dataset.unitColor = item.unitColor ? "1" : "0";
      wrap.dataset.baseSvg = item.make(); // guarda a base

      wrap.innerHTML = item.make();
      wrap.style.width = (item.default.scale || 120) * 2 + "px";
      wrap.style.opacity = (item.default.op || 100)/100;
      wrap.style.transform = `rotate(${item.default.rot||0}deg)`;
      wrap.style.zIndex = (++zTop).toString();
      wrap.style.left = (40 + Math.random()*120) + "px";
      wrap.style.top  = (40 + Math.random()*80) + "px";

      stage.appendChild(wrap);
      ghost.style.display = "none";
      selectObj(wrap);

      enableDrag(wrap);
      enableUnitBalloonPaint(wrap);
    }

    function selectObj(el){
      stage.querySelectorAll(".obj").forEach(o=>o.classList.remove("selected"));
      selected = el;
      if(!selected){
        document.getElementById("selName").textContent = "Nenhum item selecionado";
        return;
      }
      selected.classList.add("selected");
      document.getElementById("selName").textContent = selected.dataset.name;

      // sincroniza sliders
      const w = parseFloat(selected.style.width) || 240;
      const scaleVal = Math.round(w/2);
      setSlider("scale", scaleVal, "vScale", scaleVal + "%");

      const rotVal = getRotation(selected);
      setSlider("rot", rotVal, "vRot", rotVal + "¬∞");

      const opVal = Math.round((parseFloat(selected.style.opacity)||1)*100);
      setSlider("op", opVal, "vOp", opVal + "%");
    }

    function setSlider(id, v, labelId, text){
      const el = document.getElementById(id);
      el.value = v;
      document.getElementById(labelId).textContent = text;
    }

    function getRotation(el){
      // pega rotate(deg)
      const t = el.style.transform || "";
      const m = t.match(/rotate\((-?\d+)deg\)/);
      return m ? parseInt(m[1],10) : 0;
    }

    stage.addEventListener("pointerdown", (e)=>{
      const obj = e.target.closest(".obj");
      if(obj) selectObj(obj);
      else { selected = null; stage.querySelectorAll(".obj").forEach(o=>o.classList.remove("selected")); document.getElementById("selName").textContent = "Nenhum item selecionado"; }
    });

    function enableDrag(el){
      let startX=0, startY=0, origX=0, origY=0;
      el.addEventListener("pointerdown", (e)=>{
        if(e.button !== undefined && e.button !== 0) return;
        selectObj(el);
        el.setPointerCapture(e.pointerId);

        startX = e.clientX;
        startY = e.clientY;
        origX = parseFloat(el.style.left) || 0;
        origY = parseFloat(el.style.top) || 0;

        const move = (ev)=>{
          const dx = ev.clientX - startX;
          const dy = ev.clientY - startY;
          el.style.left = (origX + dx) + "px";
          el.style.top  = (origY + dy) + "px";
        };
        const up = ()=>{
          el.releasePointerCapture(e.pointerId);
          window.removeEventListener("pointermove", move);
          window.removeEventListener("pointerup", up);
        };

        window.addEventListener("pointermove", move);
        window.addEventListener("pointerup", up);
      });
    }

    // ====== CONTROLES ======
    const scale = document.getElementById("scale");
    const rot = document.getElementById("rot");
    const op = document.getElementById("op");
    const color = document.getElementById("color");

    scale.addEventListener("input", ()=>{
      if(!selected) return;
      const v = parseInt(scale.value,10);
      selected.style.width = (v*2) + "px";
      document.getElementById("vScale").textContent = v + "%";
    });

    rot.addEventListener("input", ()=>{
      if(!selected) return;
      const v = parseInt(rot.value,10);
      selected.style.transform = `rotate(${v}deg)`;
      document.getElementById("vRot").textContent = v + "¬∞";
    });

    op.addEventListener("input", ()=>{
      if(!selected) return;
      const v = parseInt(op.value,10);
      selected.style.opacity = v/100;
      document.getElementById("vOp").textContent = v + "%";
    });

    // Cor: aplicada por filtro (universal) OU por bol√£o (bal√µes)
    // Para manter ‚Äúrealista sem foto‚Äù, usamos tint via CSS filter para itens n√£o-bol√µes
    function applyColorToSelected(hex){
      if(!selected) return;
      if(selected.dataset.colorable !== "1") return;

      // se for bal√µes e modo unidade estiver ON, a cor por unidade vai ser via clique no bol√£o
      const isBalloons = selected.dataset.id === "baloes_arco";
      if(isBalloons && unitModeOn()){
        // apenas prepara cor "pincel", pintura acontece no clique do bol√£o
        return;
      }

      // padr√£o: aplica filtro simples (hue shift) baseado na cor escolhida
      // (n√£o destr√≥i o desenho, fica mais natural)
      const hue = hexToHue(hex);
      selected.querySelector("svg").style.filter = `hue-rotate(${hue}deg) saturate(1.08)`;
    }

    color.addEventListener("input", ()=> applyColorToSelected(color.value));

    document.getElementById("resetColor").addEventListener("click", ()=>{
      if(!selected) return;
      const svg = selected.querySelector("svg");
      if(svg) svg.style.filter = "";
      // reset cor de bol√µes pintados individualmente:
      if(selected.dataset.id === "baloes_arco"){
        selected.innerHTML = selected.dataset.baseSvg;
        enableDrag(selected);
        enableUnitBalloonPaint(selected);
        selectObj(selected);
      }
    });

    document.getElementById("toFront").addEventListener("click", ()=>{
      if(!selected) return;
      selected.style.zIndex = (++zTop).toString();
    });
    document.getElementById("toBack").addEventListener("click", ()=>{
      if(!selected) return;
      selected.style.zIndex = "1";
    });

    document.getElementById("dup").addEventListener("click", ()=>{
      if(!selected) return;
      const copy = selected.cloneNode(true);
      copy.classList.remove("selected");
      copy.style.left = (parseFloat(selected.style.left||"0")+28)+"px";
      copy.style.top  = (parseFloat(selected.style.top||"0")+18)+"px";
      copy.style.zIndex = (++zTop).toString();
      stage.appendChild(copy);
      enableDrag(copy);
      enableUnitBalloonPaint(copy);
      selectObj(copy);
      addCart(1);
    });

    document.getElementById("del").addEventListener("click", ()=>{
      if(!selected) return;
      selected.remove();
      selected = null;
      document.getElementById("selName").textContent = "Nenhum item selecionado";
      if(stage.querySelectorAll(".obj").length === 0) ghost.style.display = "grid";
      addCart(-1);
    });

    document.getElementById("center").addEventListener("click", ()=>{
      if(!selected) return;
      const rect = stage.getBoundingClientRect();
      selected.style.left = (rect.width/2 - (parseFloat(selected.style.width)||240)/2) + "px";
      selected.style.top  = (rect.height/2 - 140) + "px";
    });

    // ====== COR POR UNIDADE (BAL√ïES) ======
    const unitToggle = document.getElementById("unitToggle");
    unitToggle.addEventListener("click", ()=>{
      unitToggle.classList.toggle("on");
    });
    function unitModeOn(){ return unitToggle.classList.contains("on"); }

    function enableUnitBalloonPaint(wrap){
      // se n√£o for bal√µes, ignora
      if(wrap.dataset.id !== "baloes_arco") return;

      // delega clique nas bolinhas
      wrap.addEventListener("click", (e)=>{
        if(!unitModeOn()) return;
        const g = e.target.closest(".balloon");
        if(!g) return;
        e.stopPropagation();

        const desired = color.value || "#4aa8ff";
        // acha o circle principal (o 1¬∫ circle dentro do g)
        const circles = g.querySelectorAll("circle");
        const main = circles[0];
        const highlight = circles[1];
        if(!main) return;

        // pinta mantendo brilho
        main.setAttribute("fill", desired);
        main.setAttribute("stroke","rgba(255,255,255,.12)");
        if(highlight) highlight.setAttribute("fill","rgba(255,255,255,.18)");
      }, {capture:true});
    }

    // ====== UTIL: HEX -> HUE ======
    function hexToHue(hex){
      let r=0,g=0,b=0;
      hex = hex.replace("#","");
      if(hex.length===3) hex = hex.split("").map(x=>x+x).join("");
      r = parseInt(hex.slice(0,2),16)/255;
      g = parseInt(hex.slice(2,4),16)/255;
      b = parseInt(hex.slice(4,6),16)/255;
      const max = Math.max(r,g,b), min = Math.min(r,g,b);
      let h = 0;
      if(max===min) h = 0;
      else if(max===r) h = (60*((g-b)/(max-min))+360)%360;
      else if(max===g) h = (60*((b-r)/(max-min))+120)%360;
      else h = (60*((r-g)/(max-min))+240)%360;
      return Math.round(h);
    }

    // ====== TOP BUTTONS ======
    const cartCount = document.getElementById("cartCount");
    let cart = 0;
    function addCart(n){
      cart = Math.max(0, cart + n);
      cartCount.textContent = `(${cart})`;
    }

    document.getElementById("btnLimpar").addEventListener("click", ()=>{
      stage.querySelectorAll(".obj").forEach(o=>o.remove());
      selected = null;
      ghost.style.display = "grid";
      addCart(-9999);
      document.getElementById("selName").textContent = "Nenhum item selecionado";
    });

    document.getElementById("btnWhats").addEventListener("click", ()=>{
      const txt = encodeURIComponent("Ol√°! Quero montar uma decora√ß√£o. Pode me ajudar? üòä");
      // n√∫mero ajust√°vel aqui:
      const phone = "5566996223481";
      window.open(`https://wa.me/${phone}?text=${txt}`, "_blank");
    });

    document.getElementById("btnCarrinho").addEventListener("click", ()=>{
      alert(`Itens adicionados na montagem: ${cart}\n\n(Esse √© um contador simples. Quando voc√™ quiser, eu coloco carrinho real com lista e resumo.)`);
    });

    document.getElementById("btnFinalizar").addEventListener("click", ()=>{
      alert("Finalizar (Pix):\n\nAqui entra seu link/QR do Pix, contrato e envio do pedido.\nSe quiser, eu implemento a tela final com resumo + envio pro WhatsApp.");
    });

    // ====== START ======
    renderCatalog();
  </script>
</body>
</html>
